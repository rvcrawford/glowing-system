<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>


<article-meta>


<title-group>
<article-title>Near Infrared Spectroscopy Predicts Percentage Crude
Protein in Hemp Grain</article-title>
</title-group>

<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0009-0006-3052-3269</contrib-id>
<name>
<surname>Crawford</surname>
<given-names>Ryan V.</given-names>
</name>
<string-name>Ryan V. Crawford</string-name>

<email>rvc3@cornell.edu</email>
<xref ref-type="aff" rid="aff-1">a</xref>
<xref ref-type="corresp" rid="cor-1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Crawford</surname>
<given-names>Jamie</given-names>
</name>
<string-name>Jamie Crawford</string-name>

<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-7247-9186</contrib-id>
<name>
<surname>Hansen</surname>
<given-names>Julie L.</given-names>
</name>
<string-name>Julie L. Hansen</string-name>

<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-7812-7736</contrib-id>
<name>
<surname>Smart</surname>
<given-names>Lawrence B.</given-names>
</name>
<string-name>Lawrence B. Smart</string-name>

<xref ref-type="aff" rid="aff-2">b</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-7888-3366</contrib-id>
<name>
<surname>Moore</surname>
<given-names>Virginia</given-names>
</name>
<string-name>Virginia Moore</string-name>

<xref ref-type="aff" rid="aff-3">c</xref>
</contrib>
</contrib-group>
<aff id="aff-1">
<institution-wrap>
<institution>Cornell University</institution>
</institution-wrap>
<addr-line>126 Medicago Drive</addr-line>
<city>Ithaca</city>
<state>NY</state>

<postal-code>14853</postal-code>


</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Cornell AgriTech</institution>
</institution-wrap>
<addr-line>102 Hedrick Hall</addr-line>
<city>Geneva</city>
<state>NY</state>

<postal-code>14456</postal-code>


</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Cornell University</institution>
</institution-wrap>
<addr-line>162 Emerson Hall</addr-line>
<city>Ithaca</city>
<state>NY</state>

<postal-code>14853</postal-code>


</aff>
<author-notes>
<corresp id="cor-1">rvc3@cornell.edu</corresp>
</author-notes>









<history></history>


<abstract>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad
minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
ex ea commodo consequat. Duis aute irure dolor in reprehenderit in
voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur
sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt
mollit anim id est laborum.</p>
</abstract>
<kwd-group kwd-group-type="author">
<kwd>Hemp</kwd>
<kwd>Grain</kwd>
<kwd>Spectroscopy</kwd>
</kwd-group>




</article-meta>

</front>

<body>
<p><bold>first draft</bold></p>
<sec id="introduction">
  <title>1 INTRODUCTION</title>
  <p>Hemp (Cannabis sativa L.) is an annual crop with potential uses as
  a source of food or feed from grain, and bast fiber or hurd from the
  stalk. Hemp cultivars are commonly grown for one or both purposes and
  a cultivar may be referred to as a grain, fiber, or dual-purpose type.
  Because of protein’s nutritional importance, the protein content of a
  grain crop is an prime consideration for researchers, producers, and
  consumers. Whole hemp grain typically contains approximately 20-30%
  protein
  (<xref alt="Bárta et al., 2024" rid="ref-barta_proteomic_2024" ref-type="bibr">Bárta
  et al., 2024</xref>;
  <xref alt="Callaway, 2004" rid="ref-callaway_hempseed_2004" ref-type="bibr">Callaway,
  2004</xref>;
  <xref alt="Ely &amp; Fike, 2022" rid="ref-ely_industrial_2022" ref-type="bibr">Ely
  &amp; Fike, 2022</xref>). Crude protein is often used as a proxy for
  the direct measurement of protein concentration and consists of the
  multiplication of nitrogen concentration by a conversion factor, often
  6.25
  (<xref alt="Hayes, 2020" rid="ref-hayes_measuring_2020" ref-type="bibr">Hayes,
  2020</xref>). It may be expressed as a percentage (%CP).</p>
  <p>Near-infrared spectroscopy (NIRS) technology is rapid,
  non-destructive, and cheap. It consists of the measurement of NIR
  radiation reflected and absorbed from a sample (the spectra) and the
  relation of the spectra to laboratory values for components such as
  moisture, protein, fat, or fiber
  (<xref alt="Roberts et al., 2004" rid="ref-roberts_near-infrared_2004" ref-type="bibr">Roberts
  et al., 2004</xref>). NIRS technology has been used since the 1970’s
  to assess forage %CP
  (<xref alt="Reeves, 2012" rid="ref-reeves_potential_2012" ref-type="bibr">Reeves,
  2012</xref>;
  <xref alt="Williams, 1975" rid="ref-williams_application_1975" ref-type="bibr">Williams,
  1975</xref>). A NIRS calibration set often consists of samples from
  one species grown in many environments encompassing the range of
  expected values from the analyte or analytes
  (<xref alt="Chadalavada et al., 2022" rid="ref-chadalavada_nir_2022" ref-type="bibr">Chadalavada
  et al., 2022</xref>). Partial least squares regression (PLSR) is a
  typical method used in the agricultural and food sciences to relate
  spectra to analyte
  (<xref alt="Roberts et al., 2004" rid="ref-roberts_near-infrared_2004" ref-type="bibr">Roberts
  et al., 2004</xref>). PLSR calculates components that maximize
  covariance between predictor and response variables. PLSR uses some
  number of components, often selected via cross-validation, in order to
  fit the regression model and is commonly used in spectroscopy because
  it tends to work well with highly-correlated, noisy spectral data
  (<xref alt="Wold et al., 2001" rid="ref-wold_pls-regression_2001" ref-type="bibr">Wold
  et al., 2001</xref>).</p>
  <p>A NIRS-scanned sample of undamaged grain may used for other
  purposes besides its scan or it may planted as a seed. In wheat and
  corn, grain protein content has been shown to be heritable
  (<xref alt="Geyer et al., 2022" rid="ref-geyer_genetics_2022" ref-type="bibr">Geyer
  et al., 2022</xref>;
  <xref alt="Giancaspro et al., 2019" rid="ref-giancaspro_genetic_2019" ref-type="bibr">Giancaspro
  et al., 2019</xref>). This suggests (at least potentially) that NIRS
  technology could serve as resource to rapidly identify high %CP hemp
  germplasm, enabling the screening of more germplam as grain, before
  planting to the field, and thus enabling the efficient development of
  high %CP hemp grain populations.</p>
  <p>For this study, a benchtop NIR spectrometer was used to develop a
  model to predict %CP content based on a data set of hemp grain
  representing multiple years, locations, and cultivars from grain and
  dual-purpose hemp types using PLSR.</p>
</sec>
<sec id="materials-and-methods">
  <title>2 MATERIALS AND METHODS</title>
  <sec id="hemp-grain-sample-background">
    <title>2.1 Hemp Grain Sample Background</title>
    <p>Spectral data were obtained from whole (unground) hemp grain
    samples, harvested at maturity, collected from 2017 - 2021 from 18
    cultivar trials in New York (NY) (149 samples). Grain samples were
    obtained by hand sampling or mechanical harvest and were cleaned of
    chaff and dried at 30 C for six days in a forced-air dryer. All %CP
    values are as percent dry matter. In total, 149 samples from 38
    cultivars were represented in the data set. Cultivars were grain or
    dual-purpose types and included both commercially available and
    experimental material.</p>
    <p>All cultivar trials were planted in randomized complete block
    design with each cultivar replicated four times. The 2017 data were
    comprised of samples from the same thirteen cultivars sampled from
    six NY locations. For those trials, grain was harvested from each
    plot individually and aggregated by cultivar within each trial. Four
    subsamples were drawn from each aggregated sample and scanned
    separately. These spectra were averaged at each 2 nm increment. All
    remaining samples from 2018-2021 were collected on a per-plot basis.
    All possible cultivars and possible locations were represented in
    2017, but only a selected subset of cultivars and locations were
    represented in 2018-2021.</p>
  </sec>
  <sec id="spectral-data-collection-and-preprocessing">
    <title>2.2 Spectral Data Collection and Preprocessing</title>
    <p>A benchtop NIR spectrometer (FOSS/ NIR FOSS/ NIR Systems model
    5000) was used to obtain the spectra (FOSS North America, Eden
    Prairie, MN, USA). Spectra were collected every 2 nm from 1100-2498
    nm and the logarithm of reciprocal reflectance was recorded. A 1/4
    rectangular sample cup (5.7 cm × 4.6 cm) was used to scan the
    samples.</p>
    <p>WINISI software version 1.02A (Infrasoft International, Port
    Matilda, PA, USA) was used to average the spectra in 2017, as well
    as to select samples for laboratory assay. Samples were selected
    according to their spectral distance from their nearest neighbor
    within the calibration data set with a cutoff of a distance of 0.6
    H, where H is approximately equal to the squared Mahalanobis
    distance divided by the number of principal components used in the
    calculation
    (<xref alt="Garrido-Varo et al., 2019" rid="ref-garrido-varo_note_2019" ref-type="bibr">Garrido-Varo
    et al., 2019</xref>). Prior to selection selection, spectra were
    preprocessed using SNV-detrend with settings 1,4,4,1 for the
    derivative, gap, smooth, and smooth 2 settings respectively.</p>
  </sec>
  <sec id="laboratory-validation">
    <title>2.3 Laboratory Validation</title>
    <p>Laboratory assays were performed by Dairy One Forage Laboratory
    (Ithaca, NY). For those assays, 1 mm ground samples were analyzed by
    combustion using a CN628 or CN928 Carbon/Nitrogen Determinator.
    Samples from 2017 were aggregated as described above, but the
    remaining samples were not aggregated.</p>
  </sec>
  <sec id="model-development">
    <title>2.4 Model Development</title>
    <p>Training and testing sets were created by dividing the laboratory
    %CP values into tertiles according to their %CP in order to ensure
    that the range of %CP values was present in both calibration and
    testing sets. Within each tertile, 75% of the samples were randomly
    assigned to the training set and the remaining 25% were assigned to
    the testing set. For each training set, models were developed in the
    caret package using PLSR. In fitting the model, the number of
    components was optimized over a grid search from 1-20. Model
    performance was evaluated with 25 iterations of bootstrapping and
    minimized root mean squared error (RMSE) in selecting the number of
    components in the final model.</p>
    <p>Initially a number of common spectral preprocessing methods were
    tested by creating 100 training and testing sets, as described
    above. Spectral data were transformed by each of the following
    methods: 1) first derivative, 2) Savitzky-Golay (SG) using the first
    derivative, third order polynomial, and a window of size 5, 3)
    gap-segment derivative using the first derivative, a gap of 11, and
    a segment size of 5, 4) standard normal variate (SNV), 5) standard
    normal variate following Savitzky-Golay (SNV-SG) using the same SG
    parameters as above, 6) SNV-detrend with second order polynomial,
    and 7) multiplicative scatter correction. For comparison, models
    were also developed using untransformed spectra.</p>
    <p>For each of these preprocessing methods, models were fit and
    predictions were made on the corresponding testing set. Since there
    were 7 preprocessing methods as well as untransformed spectra, 8
    separate models were fit for each of the 100 sets. The relationship
    between the predicted and actual values of the test set were
    calculated via RMSE, coefficient of determination (R<sup>2</sup>),
    relative predicted deviation (RPD), and Ratio of Performance to
    InterQuartile distance (RPIQ), four common model assessment metrics.
    Larger R<sup>2</sup>, RPD and RPIQ values and smaller RMSE values
    are best. The answer to the question of exactly which values
    constitute a “good” model varies depending upon the reference
    consulted, but for simplicity’s sake researchers desired a model
    with R<sup>2</sup> &gt; 0.80, an RPD greater than 2.5 and ideally
    greater than 3 (“good” to “excellent” quantitative prediction), and
    an RPIQ greater than 2.3 but ideally greater than 4.1 prediction on
    the testing set
    (<xref alt="Chadalavada et al., 2022" rid="ref-chadalavada_nir_2022" ref-type="bibr">Chadalavada
    et al., 2022</xref>;
    <xref alt="Luce et al., 2017" rid="ref-luce_prediction_2017" ref-type="bibr">Luce
    et al., 2017</xref>;
    <xref alt="Rawal et al., 2024" rid="ref-rawal_visible_2024" ref-type="bibr">Rawal
    et al., 2024</xref>).</p>
    <p>Analyses of variance (ANOVA) were performed for each of these
    metrics in order to compare the preprocessing methods. For each
    ANOVA, each data set was considered as a subject and different
    variances were allowed for each preprocessing method. Once the most
    promising preprocessing method was identified, 1000 more training
    and testing sets were created and models were developed with that
    method. Performance on the testing sets was summarized with RMSE,
    R<sup>2</sup>, RPD, and RPIQ. The pattern of errors, expressed as
    the difference between the actual and predicted values for a given
    sample, was examined.</p>
  </sec>
  <sec id="additional-software-used">
    <title>2.5 Additional software used</title>
    <p>We used R version 4.3.3
    (<xref alt="R Core Team, 2024" rid="ref-base" ref-type="bibr">R Core
    Team, 2024</xref>) and the following R packages: caret v. 6.0.94
    (<xref alt="Kuhn &amp; Max, 2008" rid="ref-caret" ref-type="bibr">Kuhn
    &amp; Max, 2008</xref>), data.table v. 1.15.2
    (<xref alt="Barrett et al., 2024" rid="ref-datatable" ref-type="bibr">Barrett
    et al., 2024</xref>), emmeans v. 1.10.0
    (<xref alt="Lenth, 2024" rid="ref-emmeans" ref-type="bibr">Lenth,
    2024</xref>), nlme v. 3.1.163
    (<xref alt="J. Pinheiro et al., 2023" rid="ref-nlme2023" ref-type="bibr">J.
    Pinheiro et al., 2023</xref>;
    <xref alt="J. C. Pinheiro &amp; Bates, 2000" rid="ref-nlme2000" ref-type="bibr">J.
    C. Pinheiro &amp; Bates, 2000</xref>), pls v. 2.8.3
    (<xref alt="Liland et al., 2023" rid="ref-pls" ref-type="bibr">Liland
    et al., 2023</xref>), prospectr v. 0.2.7
    (<xref alt="Stevens &amp; Ramirez-Lopez, 2024" rid="ref-prospectr" ref-type="bibr">Stevens
    &amp; Ramirez-Lopez, 2024</xref>), skimr v. 2.1.5
    (<xref alt="Waring et al., 2022" rid="ref-skimr" ref-type="bibr">Waring
    et al., 2022</xref>), tidymodels v. 1.1.1
    (<xref alt="Kuhn &amp; Wickham, 2020" rid="ref-tidymodels" ref-type="bibr">Kuhn
    &amp; Wickham, 2020</xref>), tidyverse v. 2.0.0
    (<xref alt="Wickham et al., 2019" rid="ref-tidyverse" ref-type="bibr">Wickham
    et al., 2019</xref>).</p>
  </sec>
</sec>
<sec id="results-and-discussion">
  <title>3 RESULTS AND DISCUSSION</title>
  <sec id="laboratory-assay-cp-values">
    <title>3.1 Laboratory assay %CP values</title>
    <p>Laboratory assay %CP values are summarized in the following
    table. These are similar to the range of %CP values observed in the
    literature, indicating an reasonable basis for a chemometric model.
    The %CP values were left-skewed (skewness of -0.29) and two thirds
    of the samples contained more than 25% CP.</p>
    <fig id="tbl-lab-protein-vals">
      <caption><p>Table 1: Summary of Laboratory Assayed CP Values
      (Percent Dry Matter)</p></caption>
      <table-wrap>
        <table>
          <thead>
            <tr>
              <th align="right">Mean</th>
              <th align="right">Sd</th>
              <th align="right">Minimum</th>
              <th align="right">First Quartile</th>
              <th align="right">Median</th>
              <th align="right">Third Quartile</th>
              <th align="right">Maximum</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="right">26.1</td>
              <td align="right">2.5</td>
              <td align="right">20.8</td>
              <td align="right">23.9</td>
              <td align="right">26.4</td>
              <td align="right">28.2</td>
              <td align="right">30.8</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </fig>
  </sec>
  <sec id="preprocessing-methods-comparison">
    <title>3.2 Preprocessing methods comparison</title>
    <p>All preprocessing methods outperformed untransformed spectral
    data <xref alt="Table 2" rid="tbl-preproc">Table 2</xref>. Averaged
    together, all preprocessed spectra were superior to untransformed
    spectra, with lower RMSE and higher R<sup>2</sup>, RPD and RPIQ
    values (significant at <inline-formula><alternatives>
    <tex-math><![CDATA[\alpha]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula>
    level &lt;0.001). Preprocessing methods had 11.6 % lower RMSE, and
    had 3.1% higher R<sup>2</sup>, 6.3% higher RPD and7.4% higher RPIQ
    than unprocessed spectra. Preprocessed spectra also had lower
    standard errors than untransformed spectra.</p>
    <p>The SNV-SG method had the lowest RMSE and the highest
    R<sup>2</sup>, RPD and RPIQ averaging over all iterations. SNV-SG’s
    RMSE was 1.4% lower than the next best preprocessing method (SG),
    while SNV-SG’s R<sup>2</sup>, RPD, and RPIQ were 0.4%, 2.1%, and
    2.4% higher than SG respectively. However, the differences between
    the best and second best methods by metric were only statistically
    significant at <inline-formula><alternatives>
    <tex-math><![CDATA[\alpha]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula>
    &lt;0.05 for RPD and RPIQ. There is a long history of using RPD to
    evaluate chemometric models although the statistic has been
    criticized as inadequately reflecting the distribution of skewed
    populations, a situation which RPIQ was designed to address
    (<xref alt="Bellon-Maurel et al., 2010" rid="ref-bellon-maurel_critical_2010" ref-type="bibr">Bellon-Maurel
    et al., 2010</xref>). Here the data were somewhat but not heavily
    skewed and RPD and RPIQ metrics were in agreement. The superiority
    of SNV-SG by these metrics made it the best choice for the final
    model.</p>
    <fig id="tbl-preproc">
      <caption><p>Table 2: Evaluation of Preprocessing Methods by Metric
      ± Standard Error</p></caption>
      <table-wrap>
        <table>
          <colgroup>
            <col width="49%" />
            <col width="13%" />
            <col width="13%" />
            <col width="13%" />
            <col width="13%" />
          </colgroup>
          <thead>
            <tr>
              <th align="left">Preprocessing Method</th>
              <th align="left">RMSE</th>
              <th align="left"><inline-formula><alternatives>
              <tex-math><![CDATA[R^{2}]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula></th>
              <th align="left">RPD</th>
              <th align="left">RPIQ</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Standard Normal Variate following
              Savitzky-Golay</td>
              <td align="left">1.02 ± 0.012</td>
              <td align="left">0.84 ± 0.004</td>
              <td align="left">2.49 ± 0.032</td>
              <td align="left">3.97 ± 0.076</td>
            </tr>
            <tr>
              <td align="left">Savitzky-Golay</td>
              <td align="left">1.03 ± 0.012</td>
              <td align="left">0.83 ± 0.004</td>
              <td align="left">2.44 ± 0.029</td>
              <td align="left">3.88 ± 0.072</td>
            </tr>
            <tr>
              <td align="left">First Derivative</td>
              <td align="left">1.07 ± 0.013</td>
              <td align="left">0.82 ± 0.004</td>
              <td align="left">2.36 ± 0.032</td>
              <td align="left">3.77 ± 0.075</td>
            </tr>
            <tr>
              <td align="left">Standard Normal Variate</td>
              <td align="left">1.12 ± 0.016</td>
              <td align="left">0.80 ± 0.005</td>
              <td align="left">2.26 ± 0.036</td>
              <td align="left">3.61 ± 0.081</td>
            </tr>
            <tr>
              <td align="left">Gap-segment Derivative</td>
              <td align="left">1.12 ± 0.018</td>
              <td align="left">0.81 ± 0.006</td>
              <td align="left">2.26 ± 0.040</td>
              <td align="left">3.60 ± 0.086</td>
            </tr>
            <tr>
              <td align="left">Standard Normal Variate-Detrend</td>
              <td align="left">1.13 ± 0.015</td>
              <td align="left">0.80 ± 0.005</td>
              <td align="left">2.22 ± 0.035</td>
              <td align="left">3.55 ± 0.079</td>
            </tr>
            <tr>
              <td align="left">Multiplicative Scatter Correction</td>
              <td align="left">1.17 ± 0.016</td>
              <td align="left">0.79 ± 0.006</td>
              <td align="left">2.17 ± 0.035</td>
              <td align="left">3.47 ± 0.080</td>
            </tr>
            <tr>
              <td align="left">Untransformed Spectra</td>
              <td align="left">1.22 ± 0.044</td>
              <td align="left">0.79 ± 0.009</td>
              <td align="left">2.17 ± 0.052</td>
              <td align="left">3.42 ± 0.105</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </fig>
    <p>These results are not surprising. SNV and SNV-detrend both
    correct light scatter, which is often a function of differences in
    particle size and sample packing density, although SNV-detrend is
    often used for densely-packed, powdered samples
    (<xref alt="Barnes et al., 1989" rid="ref-barnes_standard_1989" ref-type="bibr">Barnes
    et al., 1989</xref>). SG is a smoothing filter that regresses on the
    signal over a series of windows, removing noise while preserving the
    signal’s shape and features
    (<xref alt="Li et al., 2020" rid="ref-li_quantitative_2020" ref-type="bibr">Li
    et al., 2020</xref>;
    <xref alt="Luo et al., 2005" rid="ref-luo_properties_2005" ref-type="bibr">Luo
    et al., 2005</xref>). Derivatives, here including SG, gap-segment,
    and first derivatives pretreatments may remove additive and
    multiplicative effects, but not necessarily light scatter; as well,
    derivatives may increase spectral noise
    (<xref alt="Rinnan et al., 2009" rid="ref-rinnan_review_2009" ref-type="bibr">Rinnan
    et al., 2009</xref>). Here, hemp grain was neither powdered nor
    densely packed but samples were subject to light scatter and noise
    due to differences in particle size in the hemp grain.</p>
    <p>The preprocessing methods examined represent a portion of those
    available. As well, these methods tend to have a number of
    user-adjustable parameters whose various permutations were not
    tested. This subset of preprocessing methods and parameters
    nonetheless contained substantial variations in model quality,
    demonstrating the importance of selecting an appropriate
    preprocessing method.</p>
  </sec>
  <sec id="final-model-development-and-summary">
    <title>3.3 Final model development and summary</title>
    <p>The model improved most rapidly as the number of components
    increased from 1 to 7, with the inclusion of each additional
    component being associated with a decrease in RMSE of 5-12% . From 8
    to 12 components, model performance continued to improve, although
    gains were more modest (there was a decrease in RMSE of 0.7-3% with
    the inclusion of each additional component). With 13 or more
    components, performance gains were minimal and the relative ranks of
    the models tended to be stable
    <xref alt="Figure 1" rid="fig-model-calibration">Figure 1</xref>.</p>
    <fig id="fig-model-calibration">
      <caption><p>Figure 1: Decreasing RMSE with increasing number of
      PCs</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-model-calibration-1.png" />
    </fig>
    <p>The final models performances on the test sets were similar, but
    not identical to, those obtained during the initial comparison of
    preprocessing methods. The final models’ mean RMSE was 1.03,
    R<sup>2</sup> was 0.83, RPD was 2.44, and RPIQ was 3.89. Five
    percent of the models were excellent by both metrics, with RPD &gt;
    3 and RPIQ &gt; 4.1, while an additional 11% of the models were
    “good” by both metrics (RPD range from 2.5 - 3.0, RPIQ range from
    2.3 - 4.1). Forty-nine percent of the models had the ability to
    approximate quantitative prediction (RPD range from 2.0 - 2.5), and
    9% of the models were able to distinguish between higher and lower
    %CP values (RPD range from 1.5 - 2.0). Therefore, 74% of the models
    had, at minimum, the ability to distinguish between high and low
    values with with two thirds of them having, at minimum, the ability
    to approximate quantitative prediction. Despite the generally good
    model performance, a subset of poor models can be seen. For example,
    <xref alt="Figure 2" rid="fig-final-metric-boxplot">Figure 2</xref>
    shows twenty-one models with R<sup>2</sup> below 0.7.</p>
    <fig id="fig-final-metric-boxplot">
      <caption><p>Figure 2: Final model test set performance (1000
      iterations)</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-final-metric-boxplot-1.png" />
    </fig>
    <p>Finally, the pattern of test set errors was examined on a
    per-sample basis by calculating the difference between the actual
    and predicted values for the samples in the test sets
    <xref alt="Figure 3" rid="fig-validation_set_performance">Figure 3</xref>
    . A linear model was fit considering the mean estimated error for
    each sample where that sample was in the test set as compared to the
    sample’s actual value. The models overestimated %CP by approximately
    0.5 % in the lowest tertile and underestimated %CP by -0.01 % and
    -0.41 % in the middle and highest tertile, respectively. The
    variance of the errors did not increase appreciably as %CP
    increased.</p>
    <fig id="fig-validation_set_performance">
      <caption><p>Figure 3: Test set prediction errors on a per-sample
      basis. Actual sample value set to 0, and samples ranked from least
      to greatest actual % CP value</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-validation_set_performance-1.png" />
    </fig>
    <p>The 15 (10%) best and 15 worst predicted samples as measured by
    the mean absolute error of prediction were identified and their
    backgrounds examined. Overall, half of the samples in the data set
    came from Ithaca, NY (“Ithaca”), while 28% were collected from
    Geneva, NY (“Geneva”)
    <xref alt="Table 3" rid="tbl-hemp_provenance">Table 3</xref>.
    However, of the 15 worst-predicted samples, 9 were from Geneva,
    while 3 of the 15 best-predicted samples were from Geneva (by
    contrast, 7 of the best-predicted and 5 of the worst-predicted
    samples came from Ithaca). Overall, samples from Geneva had the
    highest mean absolute error of prediction among locations, 61%
    greater than samples from Ithaca and 155% greater than samples from
    Freeville, NY (the only locations with more than 20 samples).</p>
    <p>This study is limited in that it represents the creation of one
    model based upon spectra collected from one machine. NIRS
    calibrations can be unique to a particular machine, even if the
    machines compared are of the same model
    (<xref alt="Reeves, 2012" rid="ref-reeves_potential_2012" ref-type="bibr">Reeves,
    2012</xref>). As well, the calibration and validation sets are
    relatively small.</p>
    <p>This research showed the promise of the use of NIRS in order to
    make predictions concerning %CP in hemp grain using PLS. Promising
    preprocessing methods were identified and a model was validated.
    Further research could refine a %CP model by including more samples,
    particularly by rectifying the class imbalance between Geneva and
    Ithaca, identifying promising spectral regions, or by examining
    other predictive methods.</p>
  </sec>
</sec>
<sec id="acknowledgments">
  <title>4 ACKNOWLEDGMENTS</title>
  <p>This work would not have been possible without the efforts of the
  field staff, undergraduate, and graduate students who planted,
  maintained, monitored and harvested these trials.</p>
</sec>
<sec id="conflict-of-interest">
  <title>5 CONFLICT OF INTEREST</title>
  <p>The authors declare no conflict of interest.</p>
</sec>
<sec id="orcid">
  <title>6 ORCID</title>
</sec>
<sec id="supplemental-material">
  <title>7 SUPPLEMENTAL MATERIAL</title>
  <fig id="tbl-hemp_provenance">
    <caption><p>Table 3: Tally of hemp cultivars and locations. Private
    cultivars are labeled “Cultivar1”, “Cultivar2”, etc., while
    experimental cultivars are labeled “Experimental1”, “Experimental2”,
    etc.</p></caption>
    <table-wrap>
      <table>
        <thead>
          <tr>
            <th align="left">Cultivar</th>
            <th align="right">Chazy</th>
            <th align="right">Freeville</th>
            <th align="right">Geneva</th>
            <th align="right">Ithaca</th>
            <th align="right">Willsboro</th>
            <th align="right">Total</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">ALTAIR</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">ANKA</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">3</td>
            <td align="right">5</td>
            <td align="right">2</td>
            <td align="right">11</td>
          </tr>
          <tr>
            <td align="left">BIALOBRZESKIE</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">3</td>
            <td align="right">4</td>
            <td align="right">1</td>
            <td align="right">9</td>
          </tr>
          <tr>
            <td align="left">CANDA</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">3</td>
          </tr>
          <tr>
            <td align="left">CFX-1</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right">5</td>
            <td align="right"></td>
            <td align="right">8</td>
          </tr>
          <tr>
            <td align="left">CFX-2</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">7</td>
          </tr>
          <tr>
            <td align="left">CRS-1</td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right">5</td>
            <td align="right"></td>
            <td align="right">9</td>
          </tr>
          <tr>
            <td align="left">CULTIVAR1</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">CULTIVAR2</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">CULTIVAR3</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">CULTIVAR4</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">EARLINA 8</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">EXPERIMENTAL1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">EXPERIMENTAL2</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">FELINA 32</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right">3</td>
            <td align="right"></td>
            <td align="right">6</td>
          </tr>
          <tr>
            <td align="left">FUTURA 75</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">3</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">8</td>
          </tr>
          <tr>
            <td align="left">GRANDI</td>
            <td align="right"></td>
            <td align="right">3</td>
            <td align="right">3</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">10</td>
          </tr>
          <tr>
            <td align="left">H-51</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right"></td>
            <td align="right">3</td>
          </tr>
          <tr>
            <td align="left">HAN-FN-H</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">HAN-NW</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">HELENA</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">HENOLA</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">2</td>
            <td align="right"></td>
            <td align="right">2</td>
          </tr>
          <tr>
            <td align="left">HLESIA</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">3</td>
            <td align="right"></td>
            <td align="right">3</td>
          </tr>
          <tr>
            <td align="left">HLIANA</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">2</td>
          </tr>
          <tr>
            <td align="left">JOEY</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">3</td>
          </tr>
          <tr>
            <td align="left">KATANI</td>
            <td align="right"></td>
            <td align="right">2</td>
            <td align="right">3</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">9</td>
          </tr>
          <tr>
            <td align="left">NEBRASKA (FERAL)</td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">2</td>
          </tr>
          <tr>
            <td align="left">PEWTER RIVER</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">PICOLO</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right">5</td>
            <td align="right"></td>
            <td align="right">8</td>
          </tr>
          <tr>
            <td align="left">PORTUGAL</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">ROCKY HEMP</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">STERLING GOLD</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">SWIFT</td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">3</td>
          </tr>
          <tr>
            <td align="left">TYGRA</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">3</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">8</td>
          </tr>
          <tr>
            <td align="left">USO-31</td>
            <td align="right">2</td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">9</td>
          </tr>
          <tr>
            <td align="left">WOJKO</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">3</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">8</td>
          </tr>
          <tr>
            <td align="left">X-59</td>
            <td align="right"></td>
            <td align="right">2</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">3</td>
          </tr>
          <tr>
            <td align="left">TOTAL</td>
            <td align="right">5</td>
            <td align="right">24</td>
            <td align="right">41</td>
            <td align="right">76</td>
            <td align="right">3</td>
            <td align="right">149</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
</sec>
<sec id="optional-sections">
  <title>8 OPTIONAL SECTIONS</title>
</sec>
<sec id="references">
  <title>9 REFERENCES</title>
</sec>
</body>

<back>
<ref-list>
  <title>10 FIGURES AND TABLES</title>
  <ref id="ref-chadalavada_nir_2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Chadalavada</surname><given-names>Keerthi</given-names></name>
        <name><surname>Anbazhagan</surname><given-names>Krithika</given-names></name>
        <name><surname>Ndour</surname><given-names>Adama</given-names></name>
        <name><surname>Choudhary</surname><given-names>Sunita</given-names></name>
        <name><surname>Palmer</surname><given-names>William</given-names></name>
        <name><surname>Flynn</surname><given-names>Jamie R</given-names></name>
        <name><surname>Mallayee</surname><given-names>Srikanth</given-names></name>
        <name><surname>Pothu</surname><given-names>Sharada</given-names></name>
        <name><surname>Prasad</surname><given-names>Kodukula Venkata Subrahamanya Vara</given-names></name>
        <name><surname>Varijakshapanikar</surname><given-names>Padmakumar</given-names></name>
        <name><surname>Jones</surname><given-names>Chris S</given-names></name>
        <name><surname>Kholová</surname><given-names>Jana</given-names></name>
      </person-group>
      <article-title>NIR Instruments and Prediction Methods for Rapid Access to Grain Protein Content in Multiple Cereals.</article-title>
      <source>Sensors (Basel, Switzerland)</source>
      <year iso-8601-date="2022-05">2022</year><month>05</month>
      <volume>22</volume>
      <issue>10</issue>
      <issn>1424-8220</issn>
      <pub-id pub-id-type="doi">10.3390/s22103710</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-reeves_potential_2012">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Reeves</surname><given-names>James B.</given-names></name>
      </person-group>
      <article-title>Potential of Near- and Mid-infrared Spectroscopy in Biofuel Production</article-title>
      <source>Communications in Soil Science and Plant Analysis</source>
      <year iso-8601-date="2012-01">2012</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-03-15">2023</year><month>03</month><day>15</day></date-in-citation>
      <volume>43</volume>
      <issue>1-2</issue>
      <issn>0010-3624</issn>
      <uri>https://doi.org/10.1080/00103624.2012.641844</uri>
      <pub-id pub-id-type="doi">10.1080/00103624.2012.641844</pub-id>
      <fpage>478</fpage>
      <lpage>495</lpage>
    </element-citation>
  </ref>
  <ref id="ref-roberts_near-infrared_2004">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Roberts</surname><given-names>Craig A</given-names></name>
        <name><surname>Workman</surname><given-names>Jerry</given-names></name>
        <name><surname>Reeves</surname><given-names>James B</given-names></name>
      </person-group>
      <source>Near-infrared spectroscopy in agriculture</source>
      <publisher-name>American Society of Agronomy</publisher-name>
      <year iso-8601-date="2004">2004</year>
    </element-citation>
  </ref>
  <ref id="ref-garrido-varo_note_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Garrido-Varo</surname><given-names>A</given-names></name>
        <name><surname>Garcia-Olmo</surname><given-names>J</given-names></name>
        <name><surname>Fearn</surname><given-names>T</given-names></name>
      </person-group>
      <article-title>A note on Mahalanobis and related distance measures in WinISI and The Unscrambler</article-title>
      <source>Journal of Near Infrared Spectroscopy</source>
      <year iso-8601-date="2019-08">2019</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-04-26">2023</year><month>04</month><day>26</day></date-in-citation>
      <volume>27</volume>
      <issue>4</issue>
      <issn>0967-0335</issn>
      <uri>https://doi.org/10.1177/0967033519848296</uri>
      <pub-id pub-id-type="doi">10.1177/0967033519848296</pub-id>
      <fpage>253</fpage>
      <lpage>258</lpage>
    </element-citation>
  </ref>
  <ref id="ref-williams_application_1975">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Williams</surname><given-names>P. C.</given-names></name>
      </person-group>
      <article-title>Application of near infrared reflectance spectroscopy to analysis of cereal grains and oilseeds</article-title>
      <source>Cereal chemistry</source>
      <year iso-8601-date="1975-07">1975</year><month>07</month>
      <volume>52</volume>
      <issue>4 p.561-576</issue>
      <issn>0009-0352</issn>
      <fpage>576</fpage>
      <lpage>561</lpage>
    </element-citation>
  </ref>
  <ref id="ref-callaway_hempseed_2004">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Callaway</surname><given-names>J. C.</given-names></name>
      </person-group>
      <article-title>Hempseed as a nutritional resource: An overview</article-title>
      <source>Euphytica</source>
      <year iso-8601-date="2004-01">2004</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-07">2024</year><month>03</month><day>07</day></date-in-citation>
      <volume>140</volume>
      <issue>1</issue>
      <issn>1573-5060</issn>
      <uri>https://doi.org/10.1007/s10681-004-4811-6</uri>
      <pub-id pub-id-type="doi">10.1007/s10681-004-4811-6</pub-id>
      <fpage>65</fpage>
      <lpage>72</lpage>
    </element-citation>
  </ref>
  <ref id="ref-barta_proteomic_2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bárta</surname><given-names>Jan</given-names></name>
        <name><surname>Roudnický</surname><given-names>Pavel</given-names></name>
        <name><surname>Jarošová</surname><given-names>Markéta</given-names></name>
        <name><surname>Zdráhal</surname><given-names>Zbyněk</given-names></name>
        <name><surname>Stupková</surname><given-names>Adéla</given-names></name>
        <name><surname>Bártová</surname><given-names>Veronika</given-names></name>
        <name><surname>Krejčová</surname><given-names>Zlatuše</given-names></name>
        <name><surname>Kyselka</surname><given-names>Jan</given-names></name>
        <name><surname>Filip</surname><given-names>Vladimír</given-names></name>
        <name><surname>Říha</surname><given-names>Václav</given-names></name>
        <name><surname>Lorenc</surname><given-names>František</given-names></name>
        <name><surname>Bedrníček</surname><given-names>Jan</given-names></name>
        <name><surname>Smetana</surname><given-names>Pavel</given-names></name>
      </person-group>
      <article-title>Proteomic Profiles of Whole Seeds, Hulls, and Dehulled Seeds of Two Industrial Hemp (Cannabis sativa L.) Cultivars</article-title>
      <source>Plants</source>
      <year iso-8601-date="2024-01">2024</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-07">2024</year><month>03</month><day>07</day></date-in-citation>
      <volume>13</volume>
      <issue>1</issue>
      <issn>2223-7747</issn>
      <uri>https://www.mdpi.com/2223-7747/13/1/111</uri>
      <pub-id pub-id-type="doi">10.3390/plants13010111</pub-id>
      <fpage>111</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-geyer_genetics_2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Geyer</surname><given-names>Manuel</given-names></name>
        <name><surname>Mohler</surname><given-names>Volker</given-names></name>
        <name><surname>Hartl</surname><given-names>Lorenz</given-names></name>
      </person-group>
      <article-title>Genetics of the Inverse Relationship between Grain Yield and Grain Protein Content in Common Wheat</article-title>
      <source>Plants</source>
      <year iso-8601-date="2022-08">2022</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-07">2024</year><month>03</month><day>07</day></date-in-citation>
      <volume>11</volume>
      <issue>16</issue>
      <issn>2223-7747</issn>
      <uri>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9413592/</uri>
      <pub-id pub-id-type="doi">10.3390/plants11162146</pub-id>
      <pub-id pub-id-type="pmid">36015449</pub-id>
      <fpage>2146</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-giancaspro_genetic_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Giancaspro</surname><given-names>Angelica</given-names></name>
        <name><surname>Giove</surname><given-names>Stefania L.</given-names></name>
        <name><surname>Blanco</surname><given-names>Antonio</given-names></name>
        <name><surname>Gadaleta</surname><given-names>Agata</given-names></name>
      </person-group>
      <article-title>Genetic Variation for Protein Content and Yield-Related Traits in a Durum Population Derived From an Inter-Specific Cross Between Hexaploid and Tetraploid Wheat Cultivars</article-title>
      <source>Frontiers in Plant Science</source>
      <year iso-8601-date="2019-11">2019</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-07">2024</year><month>03</month><day>07</day></date-in-citation>
      <volume>10</volume>
      <issn>1664-462X</issn>
      <uri>https://www.frontiersin.org/journals/plant-science/articles/10.3389/fpls.2019.01509/full</uri>
      <pub-id pub-id-type="doi">10.3389/fpls.2019.01509</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-ely_industrial_2022">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Ely</surname><given-names>Kristine</given-names></name>
        <name><surname>Fike</surname><given-names>John</given-names></name>
      </person-group>
      <article-title>Industrial Hemp and Hemp Byproducts as Sustainable Feedstuffs in Livestock Diets</article-title>
      <source>Cannabis/Hemp for Sustainable Agriculture and Materials</source>
      <person-group person-group-type="editor">
        <name><surname>Agrawal</surname><given-names>Dinesh Chandra</given-names></name>
        <name><surname>Kumar</surname><given-names>Rajiv</given-names></name>
        <name><surname>Dhanasekaran</surname><given-names>Muralikrishnan</given-names></name>
      </person-group>
      <publisher-name>Springer</publisher-name>
      <publisher-loc>Singapore</publisher-loc>
      <year iso-8601-date="2022">2022</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-08">2024</year><month>03</month><day>08</day></date-in-citation>
      <isbn>9789811687785</isbn>
      <uri>https://doi.org/10.1007/978-981-16-8778-5_6</uri>
      <pub-id pub-id-type="doi">10.1007/978-981-16-8778-5_6</pub-id>
      <fpage>145</fpage>
      <lpage>162</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hayes_measuring_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hayes</surname><given-names>Maria</given-names></name>
      </person-group>
      <article-title>Measuring Protein Content in Food: An Overview of Methods</article-title>
      <source>Foods</source>
      <year iso-8601-date="2020-09">2020</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-08">2024</year><month>03</month><day>08</day></date-in-citation>
      <volume>9</volume>
      <issue>10</issue>
      <issn>2304-8158</issn>
      <uri>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7597951/</uri>
      <pub-id pub-id-type="doi">10.3390/foods9101340</pub-id>
      <pub-id pub-id-type="pmid">32977393</pub-id>
      <fpage>1340</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-bellon-maurel_critical_2010">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bellon-Maurel</surname><given-names>Véronique</given-names></name>
        <name><surname>Fernandez-Ahumada</surname><given-names>Elvira</given-names></name>
        <name><surname>Palagos</surname><given-names>Bernard</given-names></name>
        <name><surname>Roger</surname><given-names>Jean-Michel</given-names></name>
        <name><surname>McBratney</surname><given-names>Alex</given-names></name>
      </person-group>
      <article-title>Critical review of chemometric indicators commonly used for assessing the quality of the prediction of soil attributes by NIR spectroscopy</article-title>
      <source>TrAC Trends in Analytical Chemistry</source>
      <year iso-8601-date="2010-10">2010</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-25">2024</year><month>03</month><day>25</day></date-in-citation>
      <volume>29</volume>
      <issue>9</issue>
      <issn>0165-9936</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0165993610001585</uri>
      <pub-id pub-id-type="doi">10.1016/j.trac.2010.05.006</pub-id>
      <fpage>1073</fpage>
      <lpage>1081</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wold_pls-regression_2001">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wold</surname><given-names>Svante</given-names></name>
        <name><surname>Sjöström</surname><given-names>Michael</given-names></name>
        <name><surname>Eriksson</surname><given-names>Lennart</given-names></name>
      </person-group>
      <article-title>PLS-regression: A basic tool of chemometrics</article-title>
      <source>Chemometrics and Intelligent Laboratory Systems</source>
      <year iso-8601-date="2001-10">2001</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-04-01">2024</year><month>04</month><day>01</day></date-in-citation>
      <volume>58</volume>
      <issue>2</issue>
      <issn>0169-7439</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0169743901001551</uri>
      <pub-id pub-id-type="doi">10.1016/S0169-7439(01)00155-1</pub-id>
      <fpage>109</fpage>
      <lpage>130</lpage>
    </element-citation>
  </ref>
  <ref id="ref-barnes_standard_1989">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Barnes</surname><given-names>R. J.</given-names></name>
        <name><surname>Dhanoa</surname><given-names>M. S.</given-names></name>
        <name><surname>Lister</surname><given-names>Susan J.</given-names></name>
      </person-group>
      <article-title>Standard Normal Variate Transformation and De-Trending of Near-Infrared Diffuse Reflectance Spectra</article-title>
      <source>Applied Spectroscopy</source>
      <year iso-8601-date="1989">1989</year>
      <volume>43</volume>
      <issue>5</issue>
      <uri>https://doi.org/10.1366/0003702894202201</uri>
      <pub-id pub-id-type="doi">10.1366/0003702894202201</pub-id>
      <fpage>772</fpage>
      <lpage>777</lpage>
    </element-citation>
  </ref>
  <ref id="ref-li_quantitative_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Li</surname><given-names>Yang</given-names></name>
        <name><surname>Huang</surname><given-names>Yue</given-names></name>
        <name><surname>Xia</surname><given-names>Jingjing</given-names></name>
        <name><surname>Xiong</surname><given-names>Yanmei</given-names></name>
        <name><surname>Min</surname><given-names>Shungeng</given-names></name>
      </person-group>
      <article-title>Quantitative analysis of honey adulteration by spectrum analysis combined with several high-level data fusion strategies</article-title>
      <source>Vibrational Spectroscopy</source>
      <year iso-8601-date="2020-05">2020</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-04-01">2024</year><month>04</month><day>01</day></date-in-citation>
      <volume>108</volume>
      <issn>0924-2031</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0924203120300631</uri>
      <pub-id pub-id-type="doi">10.1016/j.vibspec.2020.103060</pub-id>
      <fpage>103060</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-luo_properties_2005">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Luo</surname><given-names>Jianwen</given-names></name>
        <name><surname>Ying</surname><given-names>Kui</given-names></name>
        <name><surname>He</surname><given-names>Ping</given-names></name>
        <name><surname>Bai</surname><given-names>Jing</given-names></name>
      </person-group>
      <article-title>Properties of Savitzky–Golay digital differentiators</article-title>
      <source>Digital Signal Processing</source>
      <year iso-8601-date="2005-03">2005</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-04-01">2024</year><month>04</month><day>01</day></date-in-citation>
      <volume>15</volume>
      <issue>2</issue>
      <issn>1051-2004</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S1051200404000727</uri>
      <pub-id pub-id-type="doi">10.1016/j.dsp.2004.09.008</pub-id>
      <fpage>122</fpage>
      <lpage>136</lpage>
    </element-citation>
  </ref>
  <ref id="ref-rinnan_review_2009">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rinnan</surname><given-names>Åsmund</given-names></name>
        <name><surname>Berg</surname><given-names>Frans van den</given-names></name>
        <name><surname>Engelsen</surname><given-names>Søren Balling</given-names></name>
      </person-group>
      <article-title>Review of the most common pre-processing techniques for near-infrared spectra</article-title>
      <source>TrAC Trends in Analytical Chemistry</source>
      <year iso-8601-date="2009-11">2009</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-04-01">2024</year><month>04</month><day>01</day></date-in-citation>
      <volume>28</volume>
      <issue>10</issue>
      <issn>0165-9936</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0165993609001629</uri>
      <pub-id pub-id-type="doi">10.1016/j.trac.2009.07.007</pub-id>
      <fpage>1201</fpage>
      <lpage>1222</lpage>
    </element-citation>
  </ref>
  <ref id="ref-rawal_visible_2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rawal</surname><given-names>Ashmita</given-names></name>
        <name><surname>Hartemink</surname><given-names>Alfred</given-names></name>
        <name><surname>Zhang</surname><given-names>Yakun</given-names></name>
        <name><surname>Wang</surname><given-names>Yi</given-names></name>
        <name><surname>Lankau</surname><given-names>Richard A.</given-names></name>
        <name><surname>Ruark</surname><given-names>Matthew D.</given-names></name>
      </person-group>
      <article-title>Visible and near-infrared spectroscopy predicted leaf nitrogen contents of potato varieties under different growth and management conditions</article-title>
      <source>Precision Agriculture</source>
      <year iso-8601-date="2024-04">2024</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-04-02">2024</year><month>04</month><day>02</day></date-in-citation>
      <volume>25</volume>
      <issue>2</issue>
      <issn>1573-1618</issn>
      <uri>https://doi.org/10.1007/s11119-023-10091-z</uri>
      <pub-id pub-id-type="doi">10.1007/s11119-023-10091-z</pub-id>
      <fpage>751</fpage>
      <lpage>770</lpage>
    </element-citation>
  </ref>
  <ref id="ref-luce_prediction_2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Luce</surname><given-names>Mervin St</given-names></name>
        <name><surname>Ziadi</surname><given-names>Noura</given-names></name>
        <name><surname>Gagnon</surname><given-names>Bernard</given-names></name>
        <name><surname>Lévesque</surname><given-names>Vicky</given-names></name>
      </person-group>
      <article-title>Prediction of total carbon, total nitrogen, and pH of organic materials using visible near-infrared reflectance spectroscopy</article-title>
      <source>Canadian Journal of Soil Science</source>
      <year iso-8601-date="2017-12">2017</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-04-02">2024</year><month>04</month><day>02</day></date-in-citation>
      <volume>98</volume>
      <issue>1</issue>
      <issn>0008-4271, 1918-1841</issn>
      <uri>https://bioone.org/journals/canadian-journal-of-soil-science/volume-98/issue-1/cjss-2017-0109/Prediction-of-total-carbon-total-nitrogen-and-pH-of-organic/10.1139/cjss-2017-0109.full</uri>
      <pub-id pub-id-type="doi">10.1139/cjss-2017-0109</pub-id>
      <fpage>175</fpage>
      <lpage>179</lpage>
    </element-citation>
  </ref>
  <ref id="ref-base">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <string-name>R Core Team</string-name>
      </person-group>
      <source>R: A language and environment for statistical computing</source>
      <publisher-name>R Foundation for Statistical Computing</publisher-name>
      <publisher-loc>Vienna, Austria</publisher-loc>
      <year iso-8601-date="2024">2024</year>
      <uri>https://www.R-project.org/</uri>
    </element-citation>
  </ref>
  <ref id="ref-caret">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>Kuhn</string-name>
        <string-name>Max</string-name>
      </person-group>
      <article-title>Building predictive models in r using the caret package</article-title>
      <source>Journal of Statistical Software</source>
      <year iso-8601-date="2008">2008</year>
      <volume>28</volume>
      <issue>5</issue>
      <uri>https://www.jstatsoft.org/index.php/jss/article/view/v028i05</uri>
      <pub-id pub-id-type="doi">10.18637/jss.v028.i05</pub-id>
      <fpage>1</fpage>
      <lpage>26</lpage>
    </element-citation>
  </ref>
  <ref id="ref-datatable">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Barrett</surname><given-names>Tyson</given-names></name>
        <name><surname>Dowle</surname><given-names>Matt</given-names></name>
        <name><surname>Srinivasan</surname><given-names>Arun</given-names></name>
        <name><surname>Gorecki</surname><given-names>Jan</given-names></name>
        <name><surname>Chirico</surname><given-names>Michael</given-names></name>
        <name><surname>Hocking</surname><given-names>Toby</given-names></name>
      </person-group>
      <source>data.table: Extension of ‘data.frame’</source>
      <year iso-8601-date="2024">2024</year>
      <uri>https://CRAN.R-project.org/package=data.table</uri>
    </element-citation>
  </ref>
  <ref id="ref-emmeans">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Lenth</surname><given-names>Russell V.</given-names></name>
      </person-group>
      <source>emmeans: Estimated marginal means, aka least-squares means</source>
      <year iso-8601-date="2024">2024</year>
      <uri>https://CRAN.R-project.org/package=emmeans</uri>
    </element-citation>
  </ref>
  <ref id="ref-nlme2023">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Pinheiro</surname><given-names>José</given-names></name>
        <name><surname>Bates</surname><given-names>Douglas</given-names></name>
        <string-name>R Core Team</string-name>
      </person-group>
      <source>nlme: Linear and nonlinear mixed effects models</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://CRAN.R-project.org/package=nlme</uri>
    </element-citation>
  </ref>
  <ref id="ref-nlme2000">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Pinheiro</surname><given-names>José C.</given-names></name>
        <name><surname>Bates</surname><given-names>Douglas M.</given-names></name>
      </person-group>
      <source>Mixed-effects models in s and s-PLUS</source>
      <publisher-name>Springer</publisher-name>
      <publisher-loc>New York</publisher-loc>
      <year iso-8601-date="2000">2000</year>
      <pub-id pub-id-type="doi">10.1007/b98882</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-pls">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Liland</surname><given-names>Kristian Hovde</given-names></name>
        <name><surname>Mevik</surname><given-names>Bjørn-Helge</given-names></name>
        <name><surname>Wehrens</surname><given-names>Ron</given-names></name>
      </person-group>
      <source>pls: Partial least squares and principal component regression</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://CRAN.R-project.org/package=pls</uri>
    </element-citation>
  </ref>
  <ref id="ref-prospectr">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Stevens</surname><given-names>Antoine</given-names></name>
        <name><surname>Ramirez-Lopez</surname><given-names>Leornardo</given-names></name>
      </person-group>
      <source>An introduction to the prospectr package</source>
      <year iso-8601-date="2024">2024</year>
    </element-citation>
  </ref>
  <ref id="ref-skimr">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Waring</surname><given-names>Elin</given-names></name>
        <name><surname>Quinn</surname><given-names>Michael</given-names></name>
        <name><surname>McNamara</surname><given-names>Amelia</given-names></name>
        <name><surname>Arino de la Rubia</surname><given-names>Eduardo</given-names></name>
        <name><surname>Zhu</surname><given-names>Hao</given-names></name>
        <name><surname>Ellis</surname><given-names>Shannon</given-names></name>
      </person-group>
      <source>skimr: Compact and flexible summaries of data</source>
      <year iso-8601-date="2022">2022</year>
      <uri>https://CRAN.R-project.org/package=skimr</uri>
    </element-citation>
  </ref>
  <ref id="ref-tidymodels">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Kuhn</surname><given-names>Max</given-names></name>
        <name><surname>Wickham</surname><given-names>Hadley</given-names></name>
      </person-group>
      <source>Tidymodels: A collection of packages for modeling and machine learning using tidyverse principles.</source>
      <year iso-8601-date="2020">2020</year>
      <uri>https://www.tidymodels.org</uri>
    </element-citation>
  </ref>
  <ref id="ref-tidyverse">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wickham</surname><given-names>Hadley</given-names></name>
        <name><surname>Averick</surname><given-names>Mara</given-names></name>
        <name><surname>Bryan</surname><given-names>Jennifer</given-names></name>
        <name><surname>Chang</surname><given-names>Winston</given-names></name>
        <name><surname>McGowan</surname><given-names>Lucy D’Agostino</given-names></name>
        <name><surname>François</surname><given-names>Romain</given-names></name>
        <name><surname>Grolemund</surname><given-names>Garrett</given-names></name>
        <name><surname>Hayes</surname><given-names>Alex</given-names></name>
        <name><surname>Henry</surname><given-names>Lionel</given-names></name>
        <name><surname>Hester</surname><given-names>Jim</given-names></name>
        <name><surname>Kuhn</surname><given-names>Max</given-names></name>
        <name><surname>Pedersen</surname><given-names>Thomas Lin</given-names></name>
        <name><surname>Miller</surname><given-names>Evan</given-names></name>
        <name><surname>Bache</surname><given-names>Stephan Milton</given-names></name>
        <name><surname>Müller</surname><given-names>Kirill</given-names></name>
        <name><surname>Ooms</surname><given-names>Jeroen</given-names></name>
        <name><surname>Robinson</surname><given-names>David</given-names></name>
        <name><surname>Seidel</surname><given-names>Dana Paige</given-names></name>
        <name><surname>Spinu</surname><given-names>Vitalie</given-names></name>
        <name><surname>Takahashi</surname><given-names>Kohske</given-names></name>
        <name><surname>Vaughan</surname><given-names>Davis</given-names></name>
        <name><surname>Wilke</surname><given-names>Claus</given-names></name>
        <name><surname>Woo</surname><given-names>Kara</given-names></name>
        <name><surname>Yutani</surname><given-names>Hiroaki</given-names></name>
      </person-group>
      <article-title>Welcome to the tidyverse</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2019">2019</year>
      <volume>4</volume>
      <issue>43</issue>
      <pub-id pub-id-type="doi">10.21105/joss.01686</pub-id>
      <fpage>1686</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>

<sub-article article-type="notebook" id="nb-8-nb-article">
<front-stub>
<title-group>
<article-title>Near Infrared Spectroscopy Predicts Percentage Crude
Protein in Hemp Grain</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0009-0006-3052-3269</contrib-id>
<name>
<surname>Crawford</surname>
<given-names>Ryan V.</given-names>
</name>
<string-name>Ryan V. Crawford</string-name>

<email>rvc3@cornell.edu</email>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
<xref ref-type="corresp" rid="cor-1-nb-article">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Crawford</surname>
<given-names>Jamie</given-names>
</name>
<string-name>Jamie Crawford</string-name>

<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-7247-9186</contrib-id>
<name>
<surname>Hansen</surname>
<given-names>Julie L.</given-names>
</name>
<string-name>Julie L. Hansen</string-name>

<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-7812-7736</contrib-id>
<name>
<surname>Smart</surname>
<given-names>Lawrence B.</given-names>
</name>
<string-name>Lawrence B. Smart</string-name>

<xref ref-type="aff" rid="aff-2-nb-article">b</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-7888-3366</contrib-id>
<name>
<surname>Moore</surname>
<given-names>Virginia</given-names>
</name>
<string-name>Virginia Moore</string-name>

<xref ref-type="aff" rid="aff-3-nb-article">c</xref>
</contrib>
</contrib-group>
<aff id="aff-1-nb-article">
<institution-wrap>
<institution>Cornell University</institution>
</institution-wrap>
<addr-line>126 Medicago Drive</addr-line>
<city>Ithaca</city>
<state>NY</state>

<postal-code>14853</postal-code>


</aff>
<aff id="aff-2-nb-article">
<institution-wrap>
<institution>Cornell AgriTech</institution>
</institution-wrap>
<addr-line>102 Hedrick Hall</addr-line>
<city>Geneva</city>
<state>NY</state>

<postal-code>14456</postal-code>


</aff>
<aff id="aff-3-nb-article">
<institution-wrap>
<institution>Cornell University</institution>
</institution-wrap>
<addr-line>162 Emerson Hall</addr-line>
<city>Ithaca</city>
<state>NY</state>

<postal-code>14853</postal-code>


</aff>
<author-notes>
<corresp id="cor-1-nb-article">rvc3@cornell.edu</corresp>
</author-notes>
<abstract>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad
minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
ex ea commodo consequat. Duis aute irure dolor in reprehenderit in
voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur
sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt
mollit anim id est laborum.</p>
</abstract>
</front-stub>

<body>
<sec id="nb-code-cell-1-nb-article" specific-use="notebook-code">
<code language="r script">library(tidyverse)</code>
<code language="r script">library(data.table)</code>
<code language="r script">library(caret)</code>
<code language="r script">library(prospectr)</code>
<code language="r script">library(pls)</code>
<code language="r script">library(tidymodels)</code>
<code language="r script">library(nlme)</code>
<code language="r script">library(kableExtra)</code>
<sec id="nb-code-cell-1-output-0-nb-article" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
<sec id="nb-code-cell-1-output-1-nb-article" specific-use="notebook-output">
<preformat>
Attaching package: 'data.table'

The following objects are masked from 'package:lubridate':

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year

The following objects are masked from 'package:dplyr':

    between, first, last

The following object is masked from 'package:purrr':

    transpose</preformat>
</sec>
<sec id="nb-code-cell-1-output-2-nb-article" specific-use="notebook-output">
<preformat>Loading required package: lattice

Attaching package: 'caret'

The following object is masked from 'package:purrr':

    lift</preformat>
</sec>
<sec id="nb-code-cell-1-output-3-nb-article" specific-use="notebook-output">
<preformat>[34mprospectr version 0.2.7 -- cakes[39m
[34mcheck the package repository at: https://github.com/l-ramirez-lopez/prospectr[39m</preformat>
</sec>
<sec id="nb-code-cell-1-output-4-nb-article" specific-use="notebook-output">
<preformat>
Attaching package: 'pls'

The following object is masked from 'package:prospectr':

    msc

The following object is masked from 'package:caret':

    R2

The following object is masked from 'package:stats':

    loadings</preformat>
</sec>
<sec id="nb-code-cell-1-output-5-nb-article" specific-use="notebook-output">
<preformat>── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──
✔ broom        1.0.5      ✔ rsample      1.2.0 
✔ dials        1.2.1      ✔ tune         1.1.2 
✔ infer        1.0.6      ✔ workflows    1.1.4 
✔ modeldata    1.3.0      ✔ workflowsets 1.0.1 
✔ parsnip      1.2.0      ✔ yardstick    1.3.0 
✔ recipes      1.0.10     
── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ data.table::between()    masks dplyr::between()
✖ scales::discard()        masks purrr::discard()
✖ dplyr::filter()          masks stats::filter()
✖ data.table::first()      masks dplyr::first()
✖ recipes::fixed()         masks stringr::fixed()
✖ dplyr::lag()             masks stats::lag()
✖ data.table::last()       masks dplyr::last()
✖ caret::lift()            masks purrr::lift()
✖ yardstick::precision()   masks caret::precision()
✖ yardstick::recall()      masks caret::recall()
✖ yardstick::sensitivity() masks caret::sensitivity()
✖ yardstick::spec()        masks readr::spec()
✖ yardstick::specificity() masks caret::specificity()
✖ recipes::step()          masks stats::step()
✖ data.table::transpose()  masks purrr::transpose()
• Use suppressPackageStartupMessages() to eliminate package startup messages</preformat>
</sec>
<sec id="nb-code-cell-1-output-6-nb-article" specific-use="notebook-output">
<preformat>
Attaching package: 'nlme'

The following object is masked from 'package:dplyr':

    collapse</preformat>
</sec>
<sec id="nb-code-cell-1-output-7-nb-article" specific-use="notebook-output">
<preformat>
Attaching package: 'kableExtra'

The following object is masked from 'package:dplyr':

    group_rows</preformat>
</sec>
</sec>
<p><bold>first draft</bold></p>
<sec id="introduction-nb-article">
  <title>1 INTRODUCTION</title>
  <p>Hemp (Cannabis sativa L.) is an annual crop with potential uses as
  a source of food or feed from grain, and bast fiber or hurd from the
  stalk. Hemp cultivars are commonly grown for one or both purposes and
  a cultivar may be referred to as a grain, fiber, or dual-purpose type.
  Because of protein’s nutritional importance, the protein content of a
  grain crop is an prime consideration for researchers, producers, and
  consumers. Whole hemp grain typically contains approximately 20-30%
  protein
  (<xref alt="Bárta et al., 2024" rid="ref-barta_proteomic_2024-nb-article" ref-type="bibr">Bárta
  et al., 2024</xref>;
  <xref alt="Callaway, 2004" rid="ref-callaway_hempseed_2004-nb-article" ref-type="bibr">Callaway,
  2004</xref>;
  <xref alt="Ely &amp; Fike, 2022" rid="ref-ely_industrial_2022-nb-article" ref-type="bibr">Ely
  &amp; Fike, 2022</xref>). Crude protein is often used as a proxy for
  the direct measurement of protein concentration and consists of the
  multiplication of nitrogen concentration by a conversion factor, often
  6.25
  (<xref alt="Hayes, 2020" rid="ref-hayes_measuring_2020-nb-article" ref-type="bibr">Hayes,
  2020</xref>). It may be expressed as a percentage (%CP).</p>
  <p>Near-infrared spectroscopy (NIRS) technology is rapid,
  non-destructive, and cheap. It consists of the measurement of NIR
  radiation reflected and absorbed from a sample (the spectra) and the
  relation of the spectra to laboratory values for components such as
  moisture, protein, fat, or fiber
  (<xref alt="Roberts et al., 2004" rid="ref-roberts_near-infrared_2004-nb-article" ref-type="bibr">Roberts
  et al., 2004</xref>). NIRS technology has been used since the 1970’s
  to assess forage %CP
  (<xref alt="Reeves, 2012" rid="ref-reeves_potential_2012-nb-article" ref-type="bibr">Reeves,
  2012</xref>;
  <xref alt="Williams, 1975" rid="ref-williams_application_1975-nb-article" ref-type="bibr">Williams,
  1975</xref>). A NIRS calibration set often consists of samples from
  one species grown in many environments encompassing the range of
  expected values from the analyte or analytes
  (<xref alt="Chadalavada et al., 2022" rid="ref-chadalavada_nir_2022-nb-article" ref-type="bibr">Chadalavada
  et al., 2022</xref>). Partial least squares regression (PLSR) is a
  typical method used in the agricultural and food sciences to relate
  spectra to analyte
  (<xref alt="Roberts et al., 2004" rid="ref-roberts_near-infrared_2004-nb-article" ref-type="bibr">Roberts
  et al., 2004</xref>). PLSR calculates components that maximize
  covariance between predictor and response variables. PLSR uses some
  number of components, often selected via cross-validation, in order to
  fit the regression model and is commonly used in spectroscopy because
  it tends to work well with highly-correlated, noisy spectral data
  (<xref alt="Wold et al., 2001" rid="ref-wold_pls-regression_2001-nb-article" ref-type="bibr">Wold
  et al., 2001</xref>).</p>
  <p>A NIRS-scanned sample of undamaged grain may used for other
  purposes besides its scan or it may planted as a seed. In wheat and
  corn, grain protein content has been shown to be heritable
  (<xref alt="Geyer et al., 2022" rid="ref-geyer_genetics_2022-nb-article" ref-type="bibr">Geyer
  et al., 2022</xref>;
  <xref alt="Giancaspro et al., 2019" rid="ref-giancaspro_genetic_2019-nb-article" ref-type="bibr">Giancaspro
  et al., 2019</xref>). This suggests (at least potentially) that NIRS
  technology could serve as resource to rapidly identify high %CP hemp
  germplasm, enabling the screening of more germplam as grain, before
  planting to the field, and thus enabling the efficient development of
  high %CP hemp grain populations.</p>
  <p>For this study, a benchtop NIR spectrometer was used to develop a
  model to predict %CP content based on a data set of hemp grain
  representing multiple years, locations, and cultivars from grain and
  dual-purpose hemp types using PLSR.</p>
</sec>
<sec id="materials-and-methods-nb-article">
  <title>2 MATERIALS AND METHODS</title>
  <sec id="nb-code-cell-2-nb-article" specific-use="notebook-code">
  <code language="r script"># bckgrnd &lt;- fread(&quot;./input_data/simplified_data/background_data_set.csv&quot;) |&gt; setDT()

# spectra &lt;- fread(&quot;./input_data/simplified_data/train_test_crude_protein.csv&quot;)

 # bckgrnd[,in_ny:= ifelse(loc!=&quot;kentucky&quot;, T, F)]
 
# bg2 &lt;- bckgrnd[loc!=&quot;kentucky&quot;]

# extract indices of non-kentucky
# bg_indices &lt;- bckgrnd[loc!=&quot;kentucky&quot;, which = T]

# correct names in bg2--should be h-51, NOT hl-51

# bg2[cultivar==&quot;hl-51&quot;]$cultivar &lt;- &quot;h-51&quot;

# check to see if i did the calc correctly

# bg2[grepl(&quot;51&quot;, cultivar),]

 #looks good 
# tab &lt;-  table(bckgrnd$in_ny)


# now take correct spectra filtering out stuff from KY

# spectra_2 &lt;- spectra[bg_indices]</code>
  </sec>
  <sec id="nb-code-cell-3-nb-article" specific-use="notebook-code">
  <code language="r script"># should be correct finalized data sets, 

# notably, switches sample 2 and 7 around

full_data &lt;- fread(&quot;./input_data/final_data_set/full_hemp_data.csv&quot;)

tab &lt;-  table(full_data$in_ny)</code>
  </sec>
  <sec id="hemp-grain-sample-background-nb-article">
    <title>2.1 Hemp Grain Sample Background</title>
    <p>Spectral data were obtained from whole (unground) hemp grain
    samples, harvested at maturity, collected from 2017 - 2021 from 18
    cultivar trials in New York (NY) (149 samples). Grain samples were
    obtained by hand sampling or mechanical harvest and were cleaned of
    chaff and dried at 30 C for six days in a forced-air dryer. All %CP
    values are as percent dry matter. In total, 149 samples from 38
    cultivars were represented in the data set. Cultivars were grain or
    dual-purpose types and included both commercially available and
    experimental material.</p>
    <p>All cultivar trials were planted in randomized complete block
    design with each cultivar replicated four times. The 2017 data were
    comprised of samples from the same thirteen cultivars sampled from
    six NY locations. For those trials, grain was harvested from each
    plot individually and aggregated by cultivar within each trial. Four
    subsamples were drawn from each aggregated sample and scanned
    separately. These spectra were averaged at each 2 nm increment. All
    remaining samples from 2018-2021 were collected on a per-plot basis.
    All possible cultivars and possible locations were represented in
    2017, but only a selected subset of cultivars and locations were
    represented in 2018-2021.</p>
  </sec>
  <sec id="spectral-data-collection-and-preprocessing-nb-article">
    <title>2.2 Spectral Data Collection and Preprocessing</title>
    <p>A benchtop NIR spectrometer (FOSS/ NIR FOSS/ NIR Systems model
    5000) was used to obtain the spectra (FOSS North America, Eden
    Prairie, MN, USA). Spectra were collected every 2 nm from 1100-2498
    nm and the logarithm of reciprocal reflectance was recorded. A 1/4
    rectangular sample cup (5.7 cm × 4.6 cm) was used to scan the
    samples.</p>
    <p>WINISI software version 1.02A (Infrasoft International, Port
    Matilda, PA, USA) was used to average the spectra in 2017, as well
    as to select samples for laboratory assay. Samples were selected
    according to their spectral distance from their nearest neighbor
    within the calibration data set with a cutoff of a distance of 0.6
    H, where H is approximately equal to the squared Mahalanobis
    distance divided by the number of principal components used in the
    calculation
    (<xref alt="Garrido-Varo et al., 2019" rid="ref-garrido-varo_note_2019-nb-article" ref-type="bibr">Garrido-Varo
    et al., 2019</xref>). Prior to selection selection, spectra were
    preprocessed using SNV-detrend with settings 1,4,4,1 for the
    derivative, gap, smooth, and smooth 2 settings respectively.</p>
  </sec>
  <sec id="laboratory-validation-nb-article">
    <title>2.3 Laboratory Validation</title>
    <p>Laboratory assays were performed by Dairy One Forage Laboratory
    (Ithaca, NY). For those assays, 1 mm ground samples were analyzed by
    combustion using a CN628 or CN928 Carbon/Nitrogen Determinator.
    Samples from 2017 were aggregated as described above, but the
    remaining samples were not aggregated.</p>
  </sec>
  <sec id="model-development-nb-article">
    <title>2.4 Model Development</title>
    <p>Training and testing sets were created by dividing the laboratory
    %CP values into tertiles according to their %CP in order to ensure
    that the range of %CP values was present in both calibration and
    testing sets. Within each tertile, 75% of the samples were randomly
    assigned to the training set and the remaining 25% were assigned to
    the testing set. For each training set, models were developed in the
    caret package using PLSR. In fitting the model, the number of
    components was optimized over a grid search from 1-20. Model
    performance was evaluated with 25 iterations of bootstrapping and
    minimized root mean squared error (RMSE) in selecting the number of
    components in the final model.</p>
    <sec id="nb-code-cell-4-nb-article" specific-use="notebook-code">
    <code language="r script">preproc_key &lt;- fread(&quot;./input_data/final_data_set/preprocessing_key.csv&quot;)

preproc_key[,full_name:= c(&quot;Raw Spectra&quot;, &quot;First Derivative&quot;, &quot;Second Derivative&quot;,&quot;Savitzky-Golay&quot;, &quot;Gap-segment Derivative&quot;,
                           &quot;Standard Normal Variate&quot;, &quot;Standard Normal Variate following Savitzky-Golay&quot;, &quot;Standard Normal Variate-Detrend&quot;, &quot;Multiplicative Scatter Correction&quot;)]</code>
    </sec>
    <p>Initially a number of common spectral preprocessing methods were
    tested by creating 100 training and testing sets, as described
    above. Spectral data were transformed by each of the following
    methods: 1) first derivative, 2) Savitzky-Golay (SG) using the first
    derivative, third order polynomial, and a window of size 5, 3)
    gap-segment derivative using the first derivative, a gap of 11, and
    a segment size of 5, 4) standard normal variate (SNV), 5) standard
    normal variate following Savitzky-Golay (SNV-SG) using the same SG
    parameters as above, 6) SNV-detrend with second order polynomial,
    and 7) multiplicative scatter correction. For comparison, models
    were also developed using untransformed spectra.</p>
    <p>For each of these preprocessing methods, models were fit and
    predictions were made on the corresponding testing set. Since there
    were 7 preprocessing methods as well as untransformed spectra, 8
    separate models were fit for each of the 100 sets. The relationship
    between the predicted and actual values of the test set were
    calculated via RMSE, coefficient of determination (R<sup>2</sup>),
    relative predicted deviation (RPD), and Ratio of Performance to
    InterQuartile distance (RPIQ), four common model assessment metrics.
    Larger R<sup>2</sup>, RPD and RPIQ values and smaller RMSE values
    are best. The answer to the question of exactly which values
    constitute a “good” model varies depending upon the reference
    consulted, but for simplicity’s sake researchers desired a model
    with R<sup>2</sup> &gt; 0.80, an RPD greater than 2.5 and ideally
    greater than 3 (“good” to “excellent” quantitative prediction), and
    an RPIQ greater than 2.3 but ideally greater than 4.1 prediction on
    the testing set
    (<xref alt="Chadalavada et al., 2022" rid="ref-chadalavada_nir_2022-nb-article" ref-type="bibr">Chadalavada
    et al., 2022</xref>;
    <xref alt="Luce et al., 2017" rid="ref-luce_prediction_2017-nb-article" ref-type="bibr">Luce
    et al., 2017</xref>;
    <xref alt="Rawal et al., 2024" rid="ref-rawal_visible_2024-nb-article" ref-type="bibr">Rawal
    et al., 2024</xref>).</p>
    <p>Analyses of variance (ANOVA) were performed for each of these
    metrics in order to compare the preprocessing methods. For each
    ANOVA, each data set was considered as a subject and different
    variances were allowed for each preprocessing method. Once the most
    promising preprocessing method was identified, 1000 more training
    and testing sets were created and models were developed with that
    method. Performance on the testing sets was summarized with RMSE,
    R<sup>2</sup>, RPD, and RPIQ. The pattern of errors, expressed as
    the difference between the actual and predicted values for a given
    sample, was examined.</p>
  </sec>
  <sec id="additional-software-used-nb-article">
    <title>2.5 Additional software used</title>
    <sec id="nb-code-cell-5-nb-article" specific-use="notebook-code">
    <code language="r script">grateful::cite_packages(output = &quot;paragraph&quot;, out.dir = &quot;.&quot;,pkgs = c(&quot;base&quot;, &quot;data.table&quot;, &quot;nlme&quot;, &quot;tidyverse&quot;, &quot;caret&quot;, &quot;pls&quot;, &quot;prospectr&quot;, &quot;tidymodels&quot;, &quot;emmeans&quot;, &quot;skimr&quot;))</code>
    <p>We used R version 4.3.3
    (<xref alt="R Core Team, 2024" rid="ref-base-nb-article" ref-type="bibr">R Core
    Team, 2024</xref>) and the following R packages: caret v. 6.0.94
    (<xref alt="Kuhn &amp; Max, 2008" rid="ref-caret-nb-article" ref-type="bibr">Kuhn
    &amp; Max, 2008</xref>), data.table v. 1.15.2
    (<xref alt="Barrett et al., 2024" rid="ref-datatable-nb-article" ref-type="bibr">Barrett
    et al., 2024</xref>), emmeans v. 1.10.0
    (<xref alt="Lenth, 2024" rid="ref-emmeans-nb-article" ref-type="bibr">Lenth,
    2024</xref>), nlme v. 3.1.163
    (<xref alt="J. Pinheiro et al., 2023" rid="ref-nlme2023-nb-article" ref-type="bibr">J.
    Pinheiro et al., 2023</xref>;
    <xref alt="J. C. Pinheiro &amp; Bates, 2000" rid="ref-nlme2000-nb-article" ref-type="bibr">J.
    C. Pinheiro &amp; Bates, 2000</xref>), pls v. 2.8.3
    (<xref alt="Liland et al., 2023" rid="ref-pls-nb-article" ref-type="bibr">Liland
    et al., 2023</xref>), prospectr v. 0.2.7
    (<xref alt="Stevens &amp; Ramirez-Lopez, 2024" rid="ref-prospectr-nb-article" ref-type="bibr">Stevens
    &amp; Ramirez-Lopez, 2024</xref>), skimr v. 2.1.5
    (<xref alt="Waring et al., 2022" rid="ref-skimr-nb-article" ref-type="bibr">Waring
    et al., 2022</xref>), tidymodels v. 1.1.1
    (<xref alt="Kuhn &amp; Wickham, 2020" rid="ref-tidymodels-nb-article" ref-type="bibr">Kuhn
    &amp; Wickham, 2020</xref>), tidyverse v. 2.0.0
    (<xref alt="Wickham et al., 2019" rid="ref-tidyverse-nb-article" ref-type="bibr">Wickham
    et al., 2019</xref>).</p>
    </sec>
  </sec>
</sec>
<sec id="results-and-discussion-nb-article">
  <title>3 RESULTS AND DISCUSSION</title>
  <sec id="laboratory-assay-cp-values-nb-article">
    <title>3.1 Laboratory assay %CP values</title>
    <sec id="nb-code-cell-6-nb-article" specific-use="notebook-code">
    <code language="r script">skewness &lt;- function(x) {

    n &lt;- length(x)

    mean_x &lt;- mean(x)
    sd_x &lt;- sqrt(sum((x - mean_x)^2) / (n))

    # z-transform x and assign to z
    z &lt;- (x - mean_x) / sd_x

    # this is not an evaluation, the result is assigned to skewness
    skewness &lt;- sum(z^3) / n

    # we need to evaulate skewness
    # we could write 
    # print(skewness)
    # or
    # return(skewness)
    skewness
}</code>
    </sec>
    <p>Laboratory assay %CP values are summarized in the following
    table. These are similar to the range of %CP values observed in the
    literature, indicating an reasonable basis for a chemometric model.
    The %CP values were left-skewed (skewness of -0.29) and two thirds
    of the samples contained more than 25% CP.</p>
    <sec id="nb-code-cell-7-nb-article" specific-use="notebook-code">
    <code language="r script">my_summary &lt;- full_data$crude_protein |&gt; skimr::skim()|&gt; select(c(5:11)) |&gt; 
  mutate_all(round, 1)
names(my_summary) &lt;- c(&quot;mean&quot;, &quot;sd&quot;, &quot;minimum&quot;, &quot;first quartile&quot;, &quot;median&quot;, &quot;third quartile&quot;, &quot;maximum&quot;) |&gt; str_to_title()

knitr::kable(my_summary)</code>
    <fig id="tbl-lab-protein-vals-nb-article">
      <caption><p>Table 1: Summary of Laboratory Assayed CP Values
      (Percent Dry Matter)</p></caption>
      <table-wrap>
        <table>
          <thead>
            <tr>
              <th align="right">Mean</th>
              <th align="right">Sd</th>
              <th align="right">Minimum</th>
              <th align="right">First Quartile</th>
              <th align="right">Median</th>
              <th align="right">Third Quartile</th>
              <th align="right">Maximum</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="right">26.1</td>
              <td align="right">2.5</td>
              <td align="right">20.8</td>
              <td align="right">23.9</td>
              <td align="right">26.4</td>
              <td align="right">28.2</td>
              <td align="right">30.8</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </fig>
    </sec>
  </sec>
  <sec id="preprocessing-methods-comparison-nb-article">
    <title>3.2 Preprocessing methods comparison</title>
    <sec id="nb-code-cell-8-nb-article" specific-use="notebook-code">
    <code language="r script"># 
multi_metric &lt;- metric_set(rmse, rsq, rpiq, rpd)


# read data back in to work with it

prep_key &lt;- fread(&quot;./input_data/final_data_set/preprocessing_key.csv&quot;)

sims_key &lt;- fread(&quot;./input_data/final_data_set/preprocessing_methods_test.csv&quot;)

long_form &lt;- merge(sims_key, prep_key, all.x = T)

# now pull the metrics

# long_form[, multi_metric(y, value), by = c(&quot;id&quot;, &quot;preproc&quot;)]

summaries &lt;- long_form |&gt; 
  filter(preproc!=&quot;second_derivative&quot;) |&gt; 
  group_by(id, preproc) |&gt; 
  multi_metric(y, value)

# # comparing methods over a series of metrics...
# summaries_with_models &lt;- summaries |&gt; 
#   mutate(id = as.character(id)) |&gt; 
#   nest(data = -.metric) |&gt; 
#   mutate(mod = map(data, ~lme4::lmer(.estimate ~ preproc + (1|id), data = .x)),
#          ems = map(mod, ~emmeans::emmeans(.x, &quot;preproc&quot;) |&gt; data.frame())
#          )
# 
# summaries_with_models_2 &lt;- summaries_with_models |&gt; 
#   select(1, ems) |&gt; 
#   unnest(ems)</code>
    </sec>
    <sec id="nb-code-cell-9-nb-article" specific-use="notebook-code">
    <code language="r script"># actually, let's summarize via nlme
# set our varident
vf2 &lt;- varIdent(form= ~ 1|preproc)

# define custom contrasts
first_part &lt;- rep(1/7,7)
contrast_full &lt;- append(first_part, -1, after = 3)


custom &lt;- list(preprocess_vs_raw = contrast_full)

nlme_summaries &lt;- summaries |&gt; 
  mutate(id = as.character(id)) |&gt; 
  nest(data = -.metric) |&gt; 
  mutate(
    mod_standard = map(data, ~nlme::lme(.estimate ~ preproc, random = ~1|id, data = .x, method =&quot;ML&quot;)),
    
    mod_varident = map(data, ~nlme::lme(.estimate ~ preproc, random = ~1|id, weights = vf2, data = .x, method =&quot;ML&quot;)),
    mod_compare = map2(mod_standard, mod_varident, ~anova(.x, .y)),
         ems = map(mod_varident, ~emmeans::emmeans(.x, &quot;preproc&quot;) |&gt;multcomp::cld() |&gt;  data.frame()), 
             ems2 = map(mod_varident, ~emmeans::emmeans(.x, &quot;preproc&quot;)),
                        contrast = map(ems2, ~emmeans::contrast(.x, custom))
                                       )



nlme_summaries_with_models_2 &lt;- nlme_summaries |&gt; 
  select(1, ems) |&gt; 
  unnest(ems)</code>
    </sec>
    <sec id="nb-code-cell-10-nb-article" specific-use="notebook-code">
    <code language="r script"># add full names

to_table &lt;- nlme_summaries_with_models_2|&gt; 
  left_join(preproc_key) |&gt; 
  select('Preprocessing Method' = full_name, Metric = .metric, Estimate = emmean, SE) |&gt; 
  mutate(Estimate = paste(format(round(Estimate, 2), nsmall = 2), &quot;±&quot;, format(round(SE, 3), nsmall = 3)))</code>
    <sec id="nb-code-cell-10-output-0-nb-article" specific-use="notebook-output">
    <preformat>Joining with `by = join_by(preproc)`</preformat>
    </sec>
    </sec>
    <sec id="nb-code-cell-11-nb-article" specific-use="notebook-code">
    <code language="r script">contrasts &lt;- nlme_summaries |&gt; 
  select(.metric, contrast) |&gt; 
  transmute(.metric, tidy_contrast = map(contrast, tidy)) |&gt; 
  unnest(tidy_contrast)</code>
    </sec>
    <sec id="nb-code-cell-12-nb-article" specific-use="notebook-code">
    <code language="r script"># lead_lag summaries
lead_lag &lt;- nlme_summaries_with_models_2 |&gt; select(1:4) |&gt; 
  arrange(.metric, emmean)%&gt;% 
  group_by(.metric) |&gt; 
  mutate(lagged = lag(emmean)) %&gt;% 
  mutate(pct_change = (emmean - lagged) / lagged)|&gt; 
  mutate(lead = lead(emmean)) %&gt;% 
  mutate(pct_change_lead = (emmean - lead) / lead)</code>
    </sec>
    <sec id="nb-code-cell-13-nb-article" specific-use="notebook-code">
    <code language="r script"># percent change for contrasts

raw_contrast &lt;- nlme_summaries_with_models_2 |&gt; filter(preproc==&quot;raw&quot;) |&gt; 
  dplyr::select(1:3) |&gt; 
  left_join(contrasts |&gt; select(1,3,estimated_diff = 5)) |&gt; 
  mutate(percent_difference = estimated_diff/(emmean+estimated_diff))</code>
    <sec id="nb-code-cell-13-output-0-nb-article" specific-use="notebook-output">
    <preformat>Joining with `by = join_by(.metric)`</preformat>
    </sec>
    </sec>
    <p>All preprocessing methods outperformed untransformed spectral
    data <xref alt="Table 2" rid="tbl-preproc-nb-article">Table 2</xref>. Averaged
    together, all preprocessed spectra were superior to untransformed
    spectra, with lower RMSE and higher R<sup>2</sup>, RPD and RPIQ
    values (significant at <inline-formula><alternatives>
    <tex-math><![CDATA[\alpha]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula>
    level &lt;0.001). Preprocessing methods had 11.6 % lower RMSE, and
    had 3.1% higher R<sup>2</sup>, 6.3% higher RPD and7.4% higher RPIQ
    than unprocessed spectra. Preprocessed spectra also had lower
    standard errors than untransformed spectra.</p>
    <p>The SNV-SG method had the lowest RMSE and the highest
    R<sup>2</sup>, RPD and RPIQ averaging over all iterations. SNV-SG’s
    RMSE was 1.4% lower than the next best preprocessing method (SG),
    while SNV-SG’s R<sup>2</sup>, RPD, and RPIQ were 0.4%, 2.1%, and
    2.4% higher than SG respectively. However, the differences between
    the best and second best methods by metric were only statistically
    significant at <inline-formula><alternatives>
    <tex-math><![CDATA[\alpha]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula>
    &lt;0.05 for RPD and RPIQ. There is a long history of using RPD to
    evaluate chemometric models although the statistic has been
    criticized as inadequately reflecting the distribution of skewed
    populations, a situation which RPIQ was designed to address
    (<xref alt="Bellon-Maurel et al., 2010" rid="ref-bellon-maurel_critical_2010-nb-article" ref-type="bibr">Bellon-Maurel
    et al., 2010</xref>). Here the data were somewhat but not heavily
    skewed and RPD and RPIQ metrics were in agreement. The superiority
    of SNV-SG by these metrics made it the best choice for the final
    model.</p>
    <sec id="nb-code-cell-14-nb-article" specific-use="notebook-code">
    <code language="r script"># printable table of results

to_table2 &lt;- to_table |&gt; 
  mutate(`Preprocessing Method` = 
           case_match(`Preprocessing Method`,
             &quot;Raw Spectra&quot;~ &quot;Untransformed Spectra&quot;,
             .default=`Preprocessing Method`
           )) |&gt; 
  select(1:3) |&gt; 
  pivot_wider(names_from = Metric, values_from = Estimate) |&gt; 
  arrange(rmse) |&gt; 
  rename(RMSE = rmse, RPIQ = rpiq ) |&gt; 
  select(1,2,3,5,4)
# names(to_table2)[3] &lt;- &quot;$^{2}<!-- (F2ED4C6E)[nb-article]:/home/runner/work/glowing-system/glowing-system/index.qmd -->quot;
to_table2|&gt; 
  knitr::kable(col.names = c(&quot;Preprocessing Method&quot;, &quot;RMSE&quot;,  &quot;$R^{2}<!-- (F2ED4C6E)[nb-article]:/home/runner/work/glowing-system/glowing-system/index.qmd -->quot;,&quot;RPD&quot;, &quot;RPIQ&quot;))</code>
    <fig id="tbl-preproc-nb-article">
      <caption><p>Table 2: Evaluation of Preprocessing Methods by Metric
      ± Standard Error</p></caption>
      <table-wrap>
        <table>
          <colgroup>
            <col width="49%" />
            <col width="13%" />
            <col width="13%" />
            <col width="13%" />
            <col width="13%" />
          </colgroup>
          <thead>
            <tr>
              <th align="left">Preprocessing Method</th>
              <th align="left">RMSE</th>
              <th align="left"><inline-formula><alternatives>
              <tex-math><![CDATA[R^{2}]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula></th>
              <th align="left">RPD</th>
              <th align="left">RPIQ</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Standard Normal Variate following
              Savitzky-Golay</td>
              <td align="left">1.02 ± 0.012</td>
              <td align="left">0.84 ± 0.004</td>
              <td align="left">2.49 ± 0.032</td>
              <td align="left">3.97 ± 0.076</td>
            </tr>
            <tr>
              <td align="left">Savitzky-Golay</td>
              <td align="left">1.03 ± 0.012</td>
              <td align="left">0.83 ± 0.004</td>
              <td align="left">2.44 ± 0.029</td>
              <td align="left">3.88 ± 0.072</td>
            </tr>
            <tr>
              <td align="left">First Derivative</td>
              <td align="left">1.07 ± 0.013</td>
              <td align="left">0.82 ± 0.004</td>
              <td align="left">2.36 ± 0.032</td>
              <td align="left">3.77 ± 0.075</td>
            </tr>
            <tr>
              <td align="left">Standard Normal Variate</td>
              <td align="left">1.12 ± 0.016</td>
              <td align="left">0.80 ± 0.005</td>
              <td align="left">2.26 ± 0.036</td>
              <td align="left">3.61 ± 0.081</td>
            </tr>
            <tr>
              <td align="left">Gap-segment Derivative</td>
              <td align="left">1.12 ± 0.018</td>
              <td align="left">0.81 ± 0.006</td>
              <td align="left">2.26 ± 0.040</td>
              <td align="left">3.60 ± 0.086</td>
            </tr>
            <tr>
              <td align="left">Standard Normal Variate-Detrend</td>
              <td align="left">1.13 ± 0.015</td>
              <td align="left">0.80 ± 0.005</td>
              <td align="left">2.22 ± 0.035</td>
              <td align="left">3.55 ± 0.079</td>
            </tr>
            <tr>
              <td align="left">Multiplicative Scatter Correction</td>
              <td align="left">1.17 ± 0.016</td>
              <td align="left">0.79 ± 0.006</td>
              <td align="left">2.17 ± 0.035</td>
              <td align="left">3.47 ± 0.080</td>
            </tr>
            <tr>
              <td align="left">Untransformed Spectra</td>
              <td align="left">1.22 ± 0.044</td>
              <td align="left">0.79 ± 0.009</td>
              <td align="left">2.17 ± 0.052</td>
              <td align="left">3.42 ± 0.105</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </fig>
    </sec>
    <p>These results are not surprising. SNV and SNV-detrend both
    correct light scatter, which is often a function of differences in
    particle size and sample packing density, although SNV-detrend is
    often used for densely-packed, powdered samples
    (<xref alt="Barnes et al., 1989" rid="ref-barnes_standard_1989-nb-article" ref-type="bibr">Barnes
    et al., 1989</xref>). SG is a smoothing filter that regresses on the
    signal over a series of windows, removing noise while preserving the
    signal’s shape and features
    (<xref alt="Li et al., 2020" rid="ref-li_quantitative_2020-nb-article" ref-type="bibr">Li
    et al., 2020</xref>;
    <xref alt="Luo et al., 2005" rid="ref-luo_properties_2005-nb-article" ref-type="bibr">Luo
    et al., 2005</xref>). Derivatives, here including SG, gap-segment,
    and first derivatives pretreatments may remove additive and
    multiplicative effects, but not necessarily light scatter; as well,
    derivatives may increase spectral noise
    (<xref alt="Rinnan et al., 2009" rid="ref-rinnan_review_2009-nb-article" ref-type="bibr">Rinnan
    et al., 2009</xref>). Here, hemp grain was neither powdered nor
    densely packed but samples were subject to light scatter and noise
    due to differences in particle size in the hemp grain.</p>
    <p>The preprocessing methods examined represent a portion of those
    available. As well, these methods tend to have a number of
    user-adjustable parameters whose various permutations were not
    tested. This subset of preprocessing methods and parameters
    nonetheless contained substantial variations in model quality,
    demonstrating the importance of selecting an appropriate
    preprocessing method.</p>
  </sec>
  <sec id="final-model-development-and-summary-nb-article">
    <title>3.3 Final model development and summary</title>
    <sec id="nb-code-cell-15-nb-article" specific-use="notebook-code">
    <code language="r script">model_n_comp_statistics &lt;- fread(&quot;./input_data/final_data_set/final_model_n_component_stats.csv&quot;)

# define a function to calculate percent difference
pct_lower &lt;- function(x){
  my_lag = data.table::shift(x, type = &quot;lag&quot;)
  round((x - my_lag)/my_lag*100,2)
}

avg_change &lt;- model_n_comp_statistics[,lapply(.SD, mean),.SDcols = 3:8, by= ncomp]

change_per_pc &lt;- avg_change[, lapply(.SD, pct_lower), .SDcols = 2:7]</code>
    </sec>
    <p>The model improved most rapidly as the number of components
    increased from 1 to 7, with the inclusion of each additional
    component being associated with a decrease in RMSE of 5-12% . From 8
    to 12 components, model performance continued to improve, although
    gains were more modest (there was a decrease in RMSE of 0.7-3% with
    the inclusion of each additional component). With 13 or more
    components, performance gains were minimal and the relative ranks of
    the models tended to be stable
    <xref alt="Figure 1" rid="fig-model-calibration-nb-article">Figure 1</xref>.</p>
    <sec id="cell-fig-model-calibration-nb-article" specific-use="notebook-code">
    <code language="r script">model_n_comp_statistics |&gt; 
  ggplot(aes(as.factor(ncomp), RMSE)) + 
  geom_line(aes(group = id), alpha = 0.03) + 
  theme_classic() + 
  xlab(&quot;Crude Protein Model Number of Components&quot;) + 
  ylab(&quot;Crude Protein Model Root Mean Squared Error&quot;)</code>
    <fig id="fig-model-calibration-nb-article">
      <caption><p>Figure 1: Decreasing RMSE with increasing number of
      PCs</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-model-calibration-1.png" />
    </fig>
    </sec>
    <sec id="nb-code-cell-16-nb-article" specific-use="notebook-code">
    <code language="r script">model_final_predictions &lt;- fread(&quot;./input_data/final_data_set/final_model_predictions.csv&quot;)

final_model_table &lt;- model_final_predictions |&gt; 
  group_by(id) |&gt; 
  multi_metric(crude_protein, predicted_crude_protein) |&gt; setDT()</code>
    </sec>
    <sec id="nb-code-cell-17-nb-article" specific-use="notebook-code">
    <code language="r script"># make a final model table that spreads wide

ft2 &lt;- final_model_table[,.estimator:=NULL] |&gt; dcast(id~.metric, value.var = &quot;.estimate&quot;)

corr_coeffs &lt;- cor(ft2[,2:5])

# id the very worst fits.
low_cor_ids &lt;- ft2[rsq&lt;0.7,]$id


great_mods &lt;- ft2[rpd&gt;3&amp;rpiq&gt;4.1&amp;rsq&gt;0.8,]

good_mods &lt;- ft2[rpd&gt;2.5&amp;rpd&lt;3&amp;rpiq&lt;4.1&amp;rpiq&gt;2.3&amp;rsq&gt;0.8,]

ok_mods &lt;- ft2[rpd&gt;2.0&amp;rpd&lt;2.5&amp;rpiq&gt;2.3,]

poor_but_functional &lt;-  ft2[rpd&gt;1.5&amp;rpd&lt;2,]

all_mods &lt;- list(great_mods, good_mods, ok_mods, poor_but_functional)

full_sum &lt;- lapply(all_mods, nrow)</code>
    </sec>
    <p>The final models performances on the test sets were similar, but
    not identical to, those obtained during the initial comparison of
    preprocessing methods. The final models’ mean RMSE was 1.03,
    R<sup>2</sup> was 0.83, RPD was 2.44, and RPIQ was 3.89. Five
    percent of the models were excellent by both metrics, with RPD &gt;
    3 and RPIQ &gt; 4.1, while an additional 11% of the models were
    “good” by both metrics (RPD range from 2.5 - 3.0, RPIQ range from
    2.3 - 4.1). Forty-nine percent of the models had the ability to
    approximate quantitative prediction (RPD range from 2.0 - 2.5), and
    9% of the models were able to distinguish between higher and lower
    %CP values (RPD range from 1.5 - 2.0). Therefore, 74% of the models
    had, at minimum, the ability to distinguish between high and low
    values with with two thirds of them having, at minimum, the ability
    to approximate quantitative prediction. Despite the generally good
    model performance, a subset of poor models can be seen. For example,
    <xref alt="Figure 2" rid="fig-final-metric-boxplot-nb-article">Figure 2</xref>
    shows twenty-one models with R<sup>2</sup> below 0.7.</p>
    <sec id="nb-code-cell-18-nb-article" specific-use="notebook-code">
    <code language="r script">skim_metrics &lt;- final_model_table |&gt; 
  group_by(.metric) |&gt; 
  skimr::skim()</code>
    </sec>
    <sec id="cell-fig-final-metric-boxplot-nb-article" specific-use="notebook-code">
    <code language="r script"># setnames(model_final_predictions, &quot;V1&quot;, &quot;crude_protein&quot;)



final_model_table |&gt;
  mutate(metric2 = toupper(.metric)) |&gt; 
  ggplot(aes(x = .metric, y = .estimate)) + 
  theme_classic() + geom_boxplot() + 
  facet_wrap(nrow = 1,vars(factor(metric2, levels = c(&quot;RMSE&quot;, &quot;RSQ&quot;,&quot;RPD&quot;, &quot;RPIQ&quot;))), scales = &quot;free&quot;) +
  xlab(&quot;Metric&quot;) + ylab(&quot;Estimate&quot;)+
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank())</code>
    <fig id="fig-final-metric-boxplot-nb-article">
      <caption><p>Figure 2: Final model test set performance (1000
      iterations)</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-final-metric-boxplot-1.png" />
    </fig>
    </sec>
    <sec id="nb-code-cell-19-nb-article" specific-use="notebook-code">
    <code language="r script"># add difference calculation between predicted and observed...
model_final_predictions[,difference := predicted_crude_protein - crude_protein]</code>
    </sec>
    <sec id="nb-code-cell-20-nb-article" specific-use="notebook-code">
    <code language="r script"># my_cut &lt;- cut(spectra_2$crude_protein, 3)
# cut_dt &lt;- data.table(ith_in_data_set = 1:149, cutpoints = my_cut)


# revised_model_cutpoints
cutpoints2 &lt;- model_final_predictions |&gt; 
  distinct(ith_in_data_set, crude_protein) |&gt; 
  mutate(cutpoints = cut(crude_protein, 3)) |&gt; 
  arrange(crude_protein) |&gt; 
  mutate(plot_order = 1:n())</code>
    </sec>
    <sec id="nb-code-cell-21-nb-article" specific-use="notebook-code">
    <code language="r script">data_sum_by_sample &lt;- model_final_predictions[,lapply(.SD, mean), .SDcols = c(&quot;crude_protein&quot;, &quot;difference&quot;), by = &quot;ith_in_data_set&quot;]
setorder(data_sum_by_sample, crude_protein)
temp_dat &lt;- copy(data_sum_by_sample)
# create temporary ith
temp_dat[,tmp_ith:= 1:.N]
min_val &lt;- min(temp_dat$crude_protein)
# center this
temp_dat[,adj_cp:= crude_protein - min_val]

lm_mod &lt;- lm(difference~adj_cp, data = temp_dat) 
lm_mod_sum &lt;- summary(lm_mod)

coefs &lt;- coef(lm_mod)

preds &lt;- predict(lm_mod, temp_dat)
ds_preds &lt;- temp_dat[,c(&quot;ith_in_data_set&quot;)] |&gt; cbind(preds)

ds_cutpoints &lt;- merge(ds_preds, cutpoints2)
setorder(ds_cutpoints, plot_order)</code>
    </sec>
    <sec id="nb-code-cell-22-nb-article" specific-use="notebook-code">
    <code language="r script">sd_mod &lt;- model_final_predictions[,list(sd_diff = sd(difference), crude_protein = mean(crude_protein)), by = &quot;ith_in_data_set&quot;]
setorder(sd_mod, crude_protein)
temp_dat_sd &lt;- copy(sd_mod)
# create temporary ith
temp_dat_sd[,tmp_ith:= 1:.N]
min_val_sd &lt;- min(temp_dat_sd$crude_protein)
# center this
temp_dat_sd[,adj_cp:= crude_protein - min_val]

lm_mod_sd &lt;- lm(sd_diff~adj_cp, data = temp_dat_sd) </code>
    </sec>
    <sec id="nb-code-cell-23-nb-article" specific-use="notebook-code">
    <code language="r script"># look at worst samples info...

worst_preds &lt;- model_final_predictions[id%in%low_cor_ids]

worst &lt;- worst_preds[,.N, by = ith_in_data_set][order(N, decreasing = T)][N&gt;8]

troubles &lt;- merge(worst, full_data[,1:7], all.x = T)</code>
    </sec>
    <sec id="nb-code-cell-24-nb-article" specific-use="notebook-code">
    <code language="r script">cts &lt;- ds_cutpoints[,mean(preds), by=cutpoints]</code>
    </sec>
    <p>Finally, the pattern of test set errors was examined on a
    per-sample basis by calculating the difference between the actual
    and predicted values for the samples in the test sets
    <xref alt="Figure 3" rid="fig-validation_set_performance-nb-article">Figure 3</xref>
    . A linear model was fit considering the mean estimated error for
    each sample where that sample was in the test set as compared to the
    sample’s actual value. The models overestimated %CP by approximately
    0.5 % in the lowest tertile and underestimated %CP by -0.01 % and
    -0.41 % in the middle and highest tertile, respectively. The
    variance of the errors did not increase appreciably as %CP
    increased.</p>
    <sec id="cell-fig-validation_set_performance-nb-article" specific-use="notebook-code">
    <code language="r script"># 

model_final_predictions |&gt; 
  left_join(cutpoints2) |&gt; 
  arrange(plot_order) |&gt; 
  ggplot(aes(plot_order, crude_protein))+
  geom_point(aes(plot_order, difference), alpha = 0.05, shape = 2) +
  geom_hline(yintercept = 0, linewidth = 2, lty = 2) +
  geom_point(data = ds_cutpoints, aes(plot_order, preds), shape = 3)+
  facet_wrap( ~cutpoints, scales = &quot;free_x&quot;,
              labeller = as_labeller(c(&quot;(20.8,24.1]&quot; = &quot;Low CP (20.8 - 24.1%)&quot;,
                                       &quot;(24.1,27.5]&quot;= &quot;Medium CP (24.2 - 27.5%)&quot;,
                                       &quot;(27.5,30.8]&quot; =&quot;High CP (27.6-30.8%)&quot;)))+ 
  ylab(&quot;Crude Protein Predicted Percent Difference\nfrom Assayed Value&quot;)+
  theme_classic()+
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()) </code>
    <fig id="fig-validation_set_performance-nb-article">
      <caption><p>Figure 3: Test set prediction errors on a per-sample
      basis. Actual sample value set to 0, and samples ranked from least
      to greatest actual % CP value</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-validation_set_performance-1.png" />
    </fig>
    <sec id="cell-fig-validation_set_performance-output-0-nb-article" specific-use="notebook-output">
    <preformat>Joining with `by = join_by(crude_protein, ith_in_data_set)`</preformat>
    </sec>
    </sec>
    <sec id="nb-code-cell-25-nb-article" specific-use="notebook-code">
    <code language="r script"># look
# read in stuff for supplemental table first
supp_tab &lt;- fread(&quot;./input_data/final_data_set/cultivar_table_clean.csv&quot;)

# read in correct location key
locs2 &lt;- fread(&quot;./input_data/final_data_set/corrected_location_key.csv&quot;)

# sort highest and lowest samples...
td2 &lt;- temp_dat[order(abs(difference))]

# sort highest and lowest
td3 &lt;- td2[!c(16:134),][,grouping:=rep(c(&quot;best_predicted_10pct&quot;, &quot;worst_predicted_10_pct&quot;), each = 15)]

# incorporate background

td4_bckgrd &lt;- merge(td3, full_data[,1:7], all.x = T)

td_5 &lt;- merge( td4_bckgrd,locs2, by.y =&quot;loc&quot;, by.x= 'loc', all.x = T)


# make a prop table.
td_5_table &lt;-  with(td_5, table(grouping, loc2))

test_for_errors &lt;- merge( merge(td2, full_data[,1:7], all.x = T),locs2, by.y =&quot;loc&quot;, by.x= 'loc', all.x = T)

error_mod &lt;- lm(abs(difference)~loc2, data = test_for_errors)

error_by_loc &lt;- emmeans::emmeans(error_mod, &quot;loc2&quot;) |&gt; multcomp::cld()</code>
    </sec>
    <p>The 15 (10%) best and 15 worst predicted samples as measured by
    the mean absolute error of prediction were identified and their
    backgrounds examined. Overall, half of the samples in the data set
    came from Ithaca, NY (“Ithaca”), while 28% were collected from
    Geneva, NY (“Geneva”)
    <xref alt="Table 3" rid="tbl-hemp_provenance-nb-article">Table 3</xref>.
    However, of the 15 worst-predicted samples, 9 were from Geneva,
    while 3 of the 15 best-predicted samples were from Geneva (by
    contrast, 7 of the best-predicted and 5 of the worst-predicted
    samples came from Ithaca). Overall, samples from Geneva had the
    highest mean absolute error of prediction among locations, 61%
    greater than samples from Ithaca and 155% greater than samples from
    Freeville, NY (the only locations with more than 20 samples).</p>
    <p>This study is limited in that it represents the creation of one
    model based upon spectra collected from one machine. NIRS
    calibrations can be unique to a particular machine, even if the
    machines compared are of the same model
    (<xref alt="Reeves, 2012" rid="ref-reeves_potential_2012-nb-article" ref-type="bibr">Reeves,
    2012</xref>). As well, the calibration and validation sets are
    relatively small.</p>
    <p>This research showed the promise of the use of NIRS in order to
    make predictions concerning %CP in hemp grain using PLS. Promising
    preprocessing methods were identified and a model was validated.
    Further research could refine a %CP model by including more samples,
    particularly by rectifying the class imbalance between Geneva and
    Ithaca, identifying promising spectral regions, or by examining
    other predictive methods.</p>
  </sec>
</sec>
<sec id="acknowledgments-nb-article">
  <title>4 ACKNOWLEDGMENTS</title>
  <p>This work would not have been possible without the efforts of the
  field staff, undergraduate, and graduate students who planted,
  maintained, monitored and harvested these trials.</p>
</sec>
<sec id="conflict-of-interest-nb-article">
  <title>5 CONFLICT OF INTEREST</title>
  <p>The authors declare no conflict of interest.</p>
</sec>
<sec id="orcid-nb-article">
  <title>6 ORCID</title>
</sec>
<sec id="supplemental-material-nb-article">
  <title>7 SUPPLEMENTAL MATERIAL</title>
  <sec id="nb-code-cell-26-nb-article" specific-use="notebook-code">
  <code language="r script">supp_tab2 &lt;- copy(supp_tab)

supp_tab2[,Cultivar:=toupper(cultivar2)]
names(supp_tab2) &lt;- str_to_title(names(supp_tab2))
# get one that's sortable
st3 &lt;- supp_tab2[,c(8,2:7)]
options(knitr.kable.NA = '')
knitr::kable(st3)</code>
  <fig id="tbl-hemp_provenance-nb-article">
    <caption><p>Table 3: Tally of hemp cultivars and locations. Private
    cultivars are labeled “Cultivar1”, “Cultivar2”, etc., while
    experimental cultivars are labeled “Experimental1”, “Experimental2”,
    etc.</p></caption>
    <table-wrap>
      <table>
        <thead>
          <tr>
            <th align="left">Cultivar</th>
            <th align="right">Chazy</th>
            <th align="right">Freeville</th>
            <th align="right">Geneva</th>
            <th align="right">Ithaca</th>
            <th align="right">Willsboro</th>
            <th align="right">Total</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">ALTAIR</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">ANKA</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">3</td>
            <td align="right">5</td>
            <td align="right">2</td>
            <td align="right">11</td>
          </tr>
          <tr>
            <td align="left">BIALOBRZESKIE</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">3</td>
            <td align="right">4</td>
            <td align="right">1</td>
            <td align="right">9</td>
          </tr>
          <tr>
            <td align="left">CANDA</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">3</td>
          </tr>
          <tr>
            <td align="left">CFX-1</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right">5</td>
            <td align="right"></td>
            <td align="right">8</td>
          </tr>
          <tr>
            <td align="left">CFX-2</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">7</td>
          </tr>
          <tr>
            <td align="left">CRS-1</td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right">5</td>
            <td align="right"></td>
            <td align="right">9</td>
          </tr>
          <tr>
            <td align="left">CULTIVAR1</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">CULTIVAR2</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">CULTIVAR3</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">CULTIVAR4</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">EARLINA 8</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">EXPERIMENTAL1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">EXPERIMENTAL2</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">FELINA 32</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right">3</td>
            <td align="right"></td>
            <td align="right">6</td>
          </tr>
          <tr>
            <td align="left">FUTURA 75</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">3</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">8</td>
          </tr>
          <tr>
            <td align="left">GRANDI</td>
            <td align="right"></td>
            <td align="right">3</td>
            <td align="right">3</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">10</td>
          </tr>
          <tr>
            <td align="left">H-51</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right"></td>
            <td align="right">3</td>
          </tr>
          <tr>
            <td align="left">HAN-FN-H</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">HAN-NW</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">HELENA</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">HENOLA</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">2</td>
            <td align="right"></td>
            <td align="right">2</td>
          </tr>
          <tr>
            <td align="left">HLESIA</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">3</td>
            <td align="right"></td>
            <td align="right">3</td>
          </tr>
          <tr>
            <td align="left">HLIANA</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">2</td>
          </tr>
          <tr>
            <td align="left">JOEY</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">3</td>
          </tr>
          <tr>
            <td align="left">KATANI</td>
            <td align="right"></td>
            <td align="right">2</td>
            <td align="right">3</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">9</td>
          </tr>
          <tr>
            <td align="left">NEBRASKA (FERAL)</td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">2</td>
          </tr>
          <tr>
            <td align="left">PEWTER RIVER</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">PICOLO</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right">5</td>
            <td align="right"></td>
            <td align="right">8</td>
          </tr>
          <tr>
            <td align="left">PORTUGAL</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">ROCKY HEMP</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">STERLING GOLD</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right"></td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">SWIFT</td>
            <td align="right">1</td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">3</td>
          </tr>
          <tr>
            <td align="left">TYGRA</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">3</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">8</td>
          </tr>
          <tr>
            <td align="left">USO-31</td>
            <td align="right">2</td>
            <td align="right">1</td>
            <td align="right">2</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">9</td>
          </tr>
          <tr>
            <td align="left">WOJKO</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right">3</td>
            <td align="right">4</td>
            <td align="right"></td>
            <td align="right">8</td>
          </tr>
          <tr>
            <td align="left">X-59</td>
            <td align="right"></td>
            <td align="right">2</td>
            <td align="right"></td>
            <td align="right">1</td>
            <td align="right"></td>
            <td align="right">3</td>
          </tr>
          <tr>
            <td align="left">TOTAL</td>
            <td align="right">5</td>
            <td align="right">24</td>
            <td align="right">41</td>
            <td align="right">76</td>
            <td align="right">3</td>
            <td align="right">149</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
  </sec>
</sec>
<sec id="optional-sections-nb-article">
  <title>8 OPTIONAL SECTIONS</title>
</sec>
<sec id="references-nb-article">
  <title>9 REFERENCES</title>
</sec>
</body>



<back>
<ref-list>
  <title>10 FIGURES AND TABLES</title>
  <ref id="ref-chadalavada_nir_2022-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Chadalavada</surname><given-names>Keerthi</given-names></name>
        <name><surname>Anbazhagan</surname><given-names>Krithika</given-names></name>
        <name><surname>Ndour</surname><given-names>Adama</given-names></name>
        <name><surname>Choudhary</surname><given-names>Sunita</given-names></name>
        <name><surname>Palmer</surname><given-names>William</given-names></name>
        <name><surname>Flynn</surname><given-names>Jamie R</given-names></name>
        <name><surname>Mallayee</surname><given-names>Srikanth</given-names></name>
        <name><surname>Pothu</surname><given-names>Sharada</given-names></name>
        <name><surname>Prasad</surname><given-names>Kodukula Venkata Subrahamanya Vara</given-names></name>
        <name><surname>Varijakshapanikar</surname><given-names>Padmakumar</given-names></name>
        <name><surname>Jones</surname><given-names>Chris S</given-names></name>
        <name><surname>Kholová</surname><given-names>Jana</given-names></name>
      </person-group>
      <article-title>NIR Instruments and Prediction Methods for Rapid Access to Grain Protein Content in Multiple Cereals.</article-title>
      <source>Sensors (Basel, Switzerland)</source>
      <year iso-8601-date="2022-05">2022</year><month>05</month>
      <volume>22</volume>
      <issue>10</issue>
      <issn>1424-8220</issn>
      <pub-id pub-id-type="doi">10.3390/s22103710</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-reeves_potential_2012-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Reeves</surname><given-names>James B.</given-names></name>
      </person-group>
      <article-title>Potential of Near- and Mid-infrared Spectroscopy in Biofuel Production</article-title>
      <source>Communications in Soil Science and Plant Analysis</source>
      <year iso-8601-date="2012-01">2012</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-03-15">2023</year><month>03</month><day>15</day></date-in-citation>
      <volume>43</volume>
      <issue>1-2</issue>
      <issn>0010-3624</issn>
      <uri>https://doi.org/10.1080/00103624.2012.641844</uri>
      <pub-id pub-id-type="doi">10.1080/00103624.2012.641844</pub-id>
      <fpage>478</fpage>
      <lpage>495</lpage>
    </element-citation>
  </ref>
  <ref id="ref-roberts_near-infrared_2004-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Roberts</surname><given-names>Craig A</given-names></name>
        <name><surname>Workman</surname><given-names>Jerry</given-names></name>
        <name><surname>Reeves</surname><given-names>James B</given-names></name>
      </person-group>
      <source>Near-infrared spectroscopy in agriculture</source>
      <publisher-name>American Society of Agronomy</publisher-name>
      <year iso-8601-date="2004">2004</year>
    </element-citation>
  </ref>
  <ref id="ref-garrido-varo_note_2019-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Garrido-Varo</surname><given-names>A</given-names></name>
        <name><surname>Garcia-Olmo</surname><given-names>J</given-names></name>
        <name><surname>Fearn</surname><given-names>T</given-names></name>
      </person-group>
      <article-title>A note on Mahalanobis and related distance measures in WinISI and The Unscrambler</article-title>
      <source>Journal of Near Infrared Spectroscopy</source>
      <year iso-8601-date="2019-08">2019</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-04-26">2023</year><month>04</month><day>26</day></date-in-citation>
      <volume>27</volume>
      <issue>4</issue>
      <issn>0967-0335</issn>
      <uri>https://doi.org/10.1177/0967033519848296</uri>
      <pub-id pub-id-type="doi">10.1177/0967033519848296</pub-id>
      <fpage>253</fpage>
      <lpage>258</lpage>
    </element-citation>
  </ref>
  <ref id="ref-williams_application_1975-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Williams</surname><given-names>P. C.</given-names></name>
      </person-group>
      <article-title>Application of near infrared reflectance spectroscopy to analysis of cereal grains and oilseeds</article-title>
      <source>Cereal chemistry</source>
      <year iso-8601-date="1975-07">1975</year><month>07</month>
      <volume>52</volume>
      <issue>4 p.561-576</issue>
      <issn>0009-0352</issn>
      <fpage>576</fpage>
      <lpage>561</lpage>
    </element-citation>
  </ref>
  <ref id="ref-callaway_hempseed_2004-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Callaway</surname><given-names>J. C.</given-names></name>
      </person-group>
      <article-title>Hempseed as a nutritional resource: An overview</article-title>
      <source>Euphytica</source>
      <year iso-8601-date="2004-01">2004</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-07">2024</year><month>03</month><day>07</day></date-in-citation>
      <volume>140</volume>
      <issue>1</issue>
      <issn>1573-5060</issn>
      <uri>https://doi.org/10.1007/s10681-004-4811-6</uri>
      <pub-id pub-id-type="doi">10.1007/s10681-004-4811-6</pub-id>
      <fpage>65</fpage>
      <lpage>72</lpage>
    </element-citation>
  </ref>
  <ref id="ref-barta_proteomic_2024-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bárta</surname><given-names>Jan</given-names></name>
        <name><surname>Roudnický</surname><given-names>Pavel</given-names></name>
        <name><surname>Jarošová</surname><given-names>Markéta</given-names></name>
        <name><surname>Zdráhal</surname><given-names>Zbyněk</given-names></name>
        <name><surname>Stupková</surname><given-names>Adéla</given-names></name>
        <name><surname>Bártová</surname><given-names>Veronika</given-names></name>
        <name><surname>Krejčová</surname><given-names>Zlatuše</given-names></name>
        <name><surname>Kyselka</surname><given-names>Jan</given-names></name>
        <name><surname>Filip</surname><given-names>Vladimír</given-names></name>
        <name><surname>Říha</surname><given-names>Václav</given-names></name>
        <name><surname>Lorenc</surname><given-names>František</given-names></name>
        <name><surname>Bedrníček</surname><given-names>Jan</given-names></name>
        <name><surname>Smetana</surname><given-names>Pavel</given-names></name>
      </person-group>
      <article-title>Proteomic Profiles of Whole Seeds, Hulls, and Dehulled Seeds of Two Industrial Hemp (Cannabis sativa L.) Cultivars</article-title>
      <source>Plants</source>
      <year iso-8601-date="2024-01">2024</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-07">2024</year><month>03</month><day>07</day></date-in-citation>
      <volume>13</volume>
      <issue>1</issue>
      <issn>2223-7747</issn>
      <uri>https://www.mdpi.com/2223-7747/13/1/111</uri>
      <pub-id pub-id-type="doi">10.3390/plants13010111</pub-id>
      <fpage>111</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-geyer_genetics_2022-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Geyer</surname><given-names>Manuel</given-names></name>
        <name><surname>Mohler</surname><given-names>Volker</given-names></name>
        <name><surname>Hartl</surname><given-names>Lorenz</given-names></name>
      </person-group>
      <article-title>Genetics of the Inverse Relationship between Grain Yield and Grain Protein Content in Common Wheat</article-title>
      <source>Plants</source>
      <year iso-8601-date="2022-08">2022</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-07">2024</year><month>03</month><day>07</day></date-in-citation>
      <volume>11</volume>
      <issue>16</issue>
      <issn>2223-7747</issn>
      <uri>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9413592/</uri>
      <pub-id pub-id-type="doi">10.3390/plants11162146</pub-id>
      <pub-id pub-id-type="pmid">36015449</pub-id>
      <fpage>2146</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-giancaspro_genetic_2019-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Giancaspro</surname><given-names>Angelica</given-names></name>
        <name><surname>Giove</surname><given-names>Stefania L.</given-names></name>
        <name><surname>Blanco</surname><given-names>Antonio</given-names></name>
        <name><surname>Gadaleta</surname><given-names>Agata</given-names></name>
      </person-group>
      <article-title>Genetic Variation for Protein Content and Yield-Related Traits in a Durum Population Derived From an Inter-Specific Cross Between Hexaploid and Tetraploid Wheat Cultivars</article-title>
      <source>Frontiers in Plant Science</source>
      <year iso-8601-date="2019-11">2019</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-07">2024</year><month>03</month><day>07</day></date-in-citation>
      <volume>10</volume>
      <issn>1664-462X</issn>
      <uri>https://www.frontiersin.org/journals/plant-science/articles/10.3389/fpls.2019.01509/full</uri>
      <pub-id pub-id-type="doi">10.3389/fpls.2019.01509</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-ely_industrial_2022-nb-article">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Ely</surname><given-names>Kristine</given-names></name>
        <name><surname>Fike</surname><given-names>John</given-names></name>
      </person-group>
      <article-title>Industrial Hemp and Hemp Byproducts as Sustainable Feedstuffs in Livestock Diets</article-title>
      <source>Cannabis/Hemp for Sustainable Agriculture and Materials</source>
      <person-group person-group-type="editor">
        <name><surname>Agrawal</surname><given-names>Dinesh Chandra</given-names></name>
        <name><surname>Kumar</surname><given-names>Rajiv</given-names></name>
        <name><surname>Dhanasekaran</surname><given-names>Muralikrishnan</given-names></name>
      </person-group>
      <publisher-name>Springer</publisher-name>
      <publisher-loc>Singapore</publisher-loc>
      <year iso-8601-date="2022">2022</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-08">2024</year><month>03</month><day>08</day></date-in-citation>
      <isbn>9789811687785</isbn>
      <uri>https://doi.org/10.1007/978-981-16-8778-5_6</uri>
      <pub-id pub-id-type="doi">10.1007/978-981-16-8778-5_6</pub-id>
      <fpage>145</fpage>
      <lpage>162</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hayes_measuring_2020-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hayes</surname><given-names>Maria</given-names></name>
      </person-group>
      <article-title>Measuring Protein Content in Food: An Overview of Methods</article-title>
      <source>Foods</source>
      <year iso-8601-date="2020-09">2020</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-08">2024</year><month>03</month><day>08</day></date-in-citation>
      <volume>9</volume>
      <issue>10</issue>
      <issn>2304-8158</issn>
      <uri>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7597951/</uri>
      <pub-id pub-id-type="doi">10.3390/foods9101340</pub-id>
      <pub-id pub-id-type="pmid">32977393</pub-id>
      <fpage>1340</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-bellon-maurel_critical_2010-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bellon-Maurel</surname><given-names>Véronique</given-names></name>
        <name><surname>Fernandez-Ahumada</surname><given-names>Elvira</given-names></name>
        <name><surname>Palagos</surname><given-names>Bernard</given-names></name>
        <name><surname>Roger</surname><given-names>Jean-Michel</given-names></name>
        <name><surname>McBratney</surname><given-names>Alex</given-names></name>
      </person-group>
      <article-title>Critical review of chemometric indicators commonly used for assessing the quality of the prediction of soil attributes by NIR spectroscopy</article-title>
      <source>TrAC Trends in Analytical Chemistry</source>
      <year iso-8601-date="2010-10">2010</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-25">2024</year><month>03</month><day>25</day></date-in-citation>
      <volume>29</volume>
      <issue>9</issue>
      <issn>0165-9936</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0165993610001585</uri>
      <pub-id pub-id-type="doi">10.1016/j.trac.2010.05.006</pub-id>
      <fpage>1073</fpage>
      <lpage>1081</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wold_pls-regression_2001-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wold</surname><given-names>Svante</given-names></name>
        <name><surname>Sjöström</surname><given-names>Michael</given-names></name>
        <name><surname>Eriksson</surname><given-names>Lennart</given-names></name>
      </person-group>
      <article-title>PLS-regression: A basic tool of chemometrics</article-title>
      <source>Chemometrics and Intelligent Laboratory Systems</source>
      <year iso-8601-date="2001-10">2001</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-04-01">2024</year><month>04</month><day>01</day></date-in-citation>
      <volume>58</volume>
      <issue>2</issue>
      <issn>0169-7439</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0169743901001551</uri>
      <pub-id pub-id-type="doi">10.1016/S0169-7439(01)00155-1</pub-id>
      <fpage>109</fpage>
      <lpage>130</lpage>
    </element-citation>
  </ref>
  <ref id="ref-barnes_standard_1989-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Barnes</surname><given-names>R. J.</given-names></name>
        <name><surname>Dhanoa</surname><given-names>M. S.</given-names></name>
        <name><surname>Lister</surname><given-names>Susan J.</given-names></name>
      </person-group>
      <article-title>Standard Normal Variate Transformation and De-Trending of Near-Infrared Diffuse Reflectance Spectra</article-title>
      <source>Applied Spectroscopy</source>
      <year iso-8601-date="1989">1989</year>
      <volume>43</volume>
      <issue>5</issue>
      <uri>https://doi.org/10.1366/0003702894202201</uri>
      <pub-id pub-id-type="doi">10.1366/0003702894202201</pub-id>
      <fpage>772</fpage>
      <lpage>777</lpage>
    </element-citation>
  </ref>
  <ref id="ref-li_quantitative_2020-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Li</surname><given-names>Yang</given-names></name>
        <name><surname>Huang</surname><given-names>Yue</given-names></name>
        <name><surname>Xia</surname><given-names>Jingjing</given-names></name>
        <name><surname>Xiong</surname><given-names>Yanmei</given-names></name>
        <name><surname>Min</surname><given-names>Shungeng</given-names></name>
      </person-group>
      <article-title>Quantitative analysis of honey adulteration by spectrum analysis combined with several high-level data fusion strategies</article-title>
      <source>Vibrational Spectroscopy</source>
      <year iso-8601-date="2020-05">2020</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-04-01">2024</year><month>04</month><day>01</day></date-in-citation>
      <volume>108</volume>
      <issn>0924-2031</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0924203120300631</uri>
      <pub-id pub-id-type="doi">10.1016/j.vibspec.2020.103060</pub-id>
      <fpage>103060</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-luo_properties_2005-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Luo</surname><given-names>Jianwen</given-names></name>
        <name><surname>Ying</surname><given-names>Kui</given-names></name>
        <name><surname>He</surname><given-names>Ping</given-names></name>
        <name><surname>Bai</surname><given-names>Jing</given-names></name>
      </person-group>
      <article-title>Properties of Savitzky–Golay digital differentiators</article-title>
      <source>Digital Signal Processing</source>
      <year iso-8601-date="2005-03">2005</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-04-01">2024</year><month>04</month><day>01</day></date-in-citation>
      <volume>15</volume>
      <issue>2</issue>
      <issn>1051-2004</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S1051200404000727</uri>
      <pub-id pub-id-type="doi">10.1016/j.dsp.2004.09.008</pub-id>
      <fpage>122</fpage>
      <lpage>136</lpage>
    </element-citation>
  </ref>
  <ref id="ref-rinnan_review_2009-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rinnan</surname><given-names>Åsmund</given-names></name>
        <name><surname>Berg</surname><given-names>Frans van den</given-names></name>
        <name><surname>Engelsen</surname><given-names>Søren Balling</given-names></name>
      </person-group>
      <article-title>Review of the most common pre-processing techniques for near-infrared spectra</article-title>
      <source>TrAC Trends in Analytical Chemistry</source>
      <year iso-8601-date="2009-11">2009</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-04-01">2024</year><month>04</month><day>01</day></date-in-citation>
      <volume>28</volume>
      <issue>10</issue>
      <issn>0165-9936</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0165993609001629</uri>
      <pub-id pub-id-type="doi">10.1016/j.trac.2009.07.007</pub-id>
      <fpage>1201</fpage>
      <lpage>1222</lpage>
    </element-citation>
  </ref>
  <ref id="ref-rawal_visible_2024-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rawal</surname><given-names>Ashmita</given-names></name>
        <name><surname>Hartemink</surname><given-names>Alfred</given-names></name>
        <name><surname>Zhang</surname><given-names>Yakun</given-names></name>
        <name><surname>Wang</surname><given-names>Yi</given-names></name>
        <name><surname>Lankau</surname><given-names>Richard A.</given-names></name>
        <name><surname>Ruark</surname><given-names>Matthew D.</given-names></name>
      </person-group>
      <article-title>Visible and near-infrared spectroscopy predicted leaf nitrogen contents of potato varieties under different growth and management conditions</article-title>
      <source>Precision Agriculture</source>
      <year iso-8601-date="2024-04">2024</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-04-02">2024</year><month>04</month><day>02</day></date-in-citation>
      <volume>25</volume>
      <issue>2</issue>
      <issn>1573-1618</issn>
      <uri>https://doi.org/10.1007/s11119-023-10091-z</uri>
      <pub-id pub-id-type="doi">10.1007/s11119-023-10091-z</pub-id>
      <fpage>751</fpage>
      <lpage>770</lpage>
    </element-citation>
  </ref>
  <ref id="ref-luce_prediction_2017-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Luce</surname><given-names>Mervin St</given-names></name>
        <name><surname>Ziadi</surname><given-names>Noura</given-names></name>
        <name><surname>Gagnon</surname><given-names>Bernard</given-names></name>
        <name><surname>Lévesque</surname><given-names>Vicky</given-names></name>
      </person-group>
      <article-title>Prediction of total carbon, total nitrogen, and pH of organic materials using visible near-infrared reflectance spectroscopy</article-title>
      <source>Canadian Journal of Soil Science</source>
      <year iso-8601-date="2017-12">2017</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-04-02">2024</year><month>04</month><day>02</day></date-in-citation>
      <volume>98</volume>
      <issue>1</issue>
      <issn>0008-4271, 1918-1841</issn>
      <uri>https://bioone.org/journals/canadian-journal-of-soil-science/volume-98/issue-1/cjss-2017-0109/Prediction-of-total-carbon-total-nitrogen-and-pH-of-organic/10.1139/cjss-2017-0109.full</uri>
      <pub-id pub-id-type="doi">10.1139/cjss-2017-0109</pub-id>
      <fpage>175</fpage>
      <lpage>179</lpage>
    </element-citation>
  </ref>
  <ref id="ref-base-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <string-name>R Core Team</string-name>
      </person-group>
      <source>R: A language and environment for statistical computing</source>
      <publisher-name>R Foundation for Statistical Computing</publisher-name>
      <publisher-loc>Vienna, Austria</publisher-loc>
      <year iso-8601-date="2024">2024</year>
      <uri>https://www.R-project.org/</uri>
    </element-citation>
  </ref>
  <ref id="ref-caret-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>Kuhn</string-name>
        <string-name>Max</string-name>
      </person-group>
      <article-title>Building predictive models in r using the caret package</article-title>
      <source>Journal of Statistical Software</source>
      <year iso-8601-date="2008">2008</year>
      <volume>28</volume>
      <issue>5</issue>
      <uri>https://www.jstatsoft.org/index.php/jss/article/view/v028i05</uri>
      <pub-id pub-id-type="doi">10.18637/jss.v028.i05</pub-id>
      <fpage>1</fpage>
      <lpage>26</lpage>
    </element-citation>
  </ref>
  <ref id="ref-datatable-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Barrett</surname><given-names>Tyson</given-names></name>
        <name><surname>Dowle</surname><given-names>Matt</given-names></name>
        <name><surname>Srinivasan</surname><given-names>Arun</given-names></name>
        <name><surname>Gorecki</surname><given-names>Jan</given-names></name>
        <name><surname>Chirico</surname><given-names>Michael</given-names></name>
        <name><surname>Hocking</surname><given-names>Toby</given-names></name>
      </person-group>
      <source>data.table: Extension of ‘data.frame’</source>
      <year iso-8601-date="2024">2024</year>
      <uri>https://CRAN.R-project.org/package=data.table</uri>
    </element-citation>
  </ref>
  <ref id="ref-emmeans-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Lenth</surname><given-names>Russell V.</given-names></name>
      </person-group>
      <source>emmeans: Estimated marginal means, aka least-squares means</source>
      <year iso-8601-date="2024">2024</year>
      <uri>https://CRAN.R-project.org/package=emmeans</uri>
    </element-citation>
  </ref>
  <ref id="ref-nlme2023-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Pinheiro</surname><given-names>José</given-names></name>
        <name><surname>Bates</surname><given-names>Douglas</given-names></name>
        <string-name>R Core Team</string-name>
      </person-group>
      <source>nlme: Linear and nonlinear mixed effects models</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://CRAN.R-project.org/package=nlme</uri>
    </element-citation>
  </ref>
  <ref id="ref-nlme2000-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Pinheiro</surname><given-names>José C.</given-names></name>
        <name><surname>Bates</surname><given-names>Douglas M.</given-names></name>
      </person-group>
      <source>Mixed-effects models in s and s-PLUS</source>
      <publisher-name>Springer</publisher-name>
      <publisher-loc>New York</publisher-loc>
      <year iso-8601-date="2000">2000</year>
      <pub-id pub-id-type="doi">10.1007/b98882</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-pls-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Liland</surname><given-names>Kristian Hovde</given-names></name>
        <name><surname>Mevik</surname><given-names>Bjørn-Helge</given-names></name>
        <name><surname>Wehrens</surname><given-names>Ron</given-names></name>
      </person-group>
      <source>pls: Partial least squares and principal component regression</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://CRAN.R-project.org/package=pls</uri>
    </element-citation>
  </ref>
  <ref id="ref-prospectr-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Stevens</surname><given-names>Antoine</given-names></name>
        <name><surname>Ramirez-Lopez</surname><given-names>Leornardo</given-names></name>
      </person-group>
      <source>An introduction to the prospectr package</source>
      <year iso-8601-date="2024">2024</year>
    </element-citation>
  </ref>
  <ref id="ref-skimr-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Waring</surname><given-names>Elin</given-names></name>
        <name><surname>Quinn</surname><given-names>Michael</given-names></name>
        <name><surname>McNamara</surname><given-names>Amelia</given-names></name>
        <name><surname>Arino de la Rubia</surname><given-names>Eduardo</given-names></name>
        <name><surname>Zhu</surname><given-names>Hao</given-names></name>
        <name><surname>Ellis</surname><given-names>Shannon</given-names></name>
      </person-group>
      <source>skimr: Compact and flexible summaries of data</source>
      <year iso-8601-date="2022">2022</year>
      <uri>https://CRAN.R-project.org/package=skimr</uri>
    </element-citation>
  </ref>
  <ref id="ref-tidymodels-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Kuhn</surname><given-names>Max</given-names></name>
        <name><surname>Wickham</surname><given-names>Hadley</given-names></name>
      </person-group>
      <source>Tidymodels: A collection of packages for modeling and machine learning using tidyverse principles.</source>
      <year iso-8601-date="2020">2020</year>
      <uri>https://www.tidymodels.org</uri>
    </element-citation>
  </ref>
  <ref id="ref-tidyverse-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wickham</surname><given-names>Hadley</given-names></name>
        <name><surname>Averick</surname><given-names>Mara</given-names></name>
        <name><surname>Bryan</surname><given-names>Jennifer</given-names></name>
        <name><surname>Chang</surname><given-names>Winston</given-names></name>
        <name><surname>McGowan</surname><given-names>Lucy D’Agostino</given-names></name>
        <name><surname>François</surname><given-names>Romain</given-names></name>
        <name><surname>Grolemund</surname><given-names>Garrett</given-names></name>
        <name><surname>Hayes</surname><given-names>Alex</given-names></name>
        <name><surname>Henry</surname><given-names>Lionel</given-names></name>
        <name><surname>Hester</surname><given-names>Jim</given-names></name>
        <name><surname>Kuhn</surname><given-names>Max</given-names></name>
        <name><surname>Pedersen</surname><given-names>Thomas Lin</given-names></name>
        <name><surname>Miller</surname><given-names>Evan</given-names></name>
        <name><surname>Bache</surname><given-names>Stephan Milton</given-names></name>
        <name><surname>Müller</surname><given-names>Kirill</given-names></name>
        <name><surname>Ooms</surname><given-names>Jeroen</given-names></name>
        <name><surname>Robinson</surname><given-names>David</given-names></name>
        <name><surname>Seidel</surname><given-names>Dana Paige</given-names></name>
        <name><surname>Spinu</surname><given-names>Vitalie</given-names></name>
        <name><surname>Takahashi</surname><given-names>Kohske</given-names></name>
        <name><surname>Vaughan</surname><given-names>Davis</given-names></name>
        <name><surname>Wilke</surname><given-names>Claus</given-names></name>
        <name><surname>Woo</surname><given-names>Kara</given-names></name>
        <name><surname>Yutani</surname><given-names>Hiroaki</given-names></name>
      </person-group>
      <article-title>Welcome to the tidyverse</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2019">2019</year>
      <volume>4</volume>
      <issue>43</issue>
      <pub-id pub-id-type="doi">10.21105/joss.01686</pub-id>
      <fpage>1686</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-4-nb-1">
<front-stub>
<title-group>
<article-title>Explore Earthquakes</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Wickham</surname>
<given-names>Charlotte</given-names>
</name>
<string-name>Charlotte Wickham</string-name>

</contrib>
</contrib-group>
</front-stub>

<body>
<sec id="nb-code-cell-1-nb-1" specific-use="notebook-code">
<code language="r script">library(tidyverse)
</code>
<sec id="nb-code-cell-1-output-0-nb-1" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
</sec>
<p>Read a clean version of data:</p>
<sec id="nb-code-cell-2-nb-1" specific-use="notebook-code">
<code language="r script">la_palma &lt;- read_csv(&quot;la-palma.csv&quot;)
</code>
<sec id="nb-code-cell-2-output-0-nb-1" specific-use="notebook-output">
<preformat>Rows: 11347 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
dbl  (4): Longitude, Latitude, Depth(km), Magnitude
dttm (1): DateTime

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
</sec>
</sec>
<p>Create spatial plot:</p>
<sec id="cell-fig-spatial-plot-nb-1" specific-use="notebook-code">
<code language="r script">#|   against longitude.&quot;
la_palma |&gt; 
  ggplot(aes(Longitude, Latitude)) +
  geom_point(aes(color = Magnitude, size = 40-`Depth(km)`)) +
  scale_color_viridis_c(direction = -1) + 
  scale_size(range = c(0.5, 2), guide = &quot;none&quot;) +
  theme_bw()
</code>
<fig id="fig-spatial-plot-nb-1">
  <caption><p>Locations of earthquakes on La Palma since
  2017</p></caption>
  <graphic mimetype="image" mime-subtype="png" xlink:href="explore-earthquakes_files/figure-jats/fig-spatial-plot-1.png" />
</fig>
</sec>
</body>



<back>
</back>


</sub-article>

</article>